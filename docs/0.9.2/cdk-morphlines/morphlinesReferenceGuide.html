
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2014-05-06
 Rendered using Maven Reflow Skin 1.0.0 (http://andriusvelykis.github.com/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>CDK Morphlines Parent - Cloudera Morphlines Reference Guide</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap.min.css" rel="stylesheet" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/docs.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />
		
		<link href="http://yandex.st/highlightjs/7.3/styles/github.min.css" rel="stylesheet" />
		
		<link href="./css/lightbox.css" rel="stylesheet" />
		
		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->

	</head>

	<body class="page-morphlinesreferenceguide project-cdk-morphlines" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<div class="brand">Cloudera Development Kit</div>
					<div class="nav-collapse">
						<ul class="nav pull-right">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Main <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="../index.html" title="Home">Home </a></li>
									<li><a href="../release_notes.html" title="Release Notes">Release Notes </a></li>
									<li><a href="../apidocs/index.html" title="Javadoc">Javadoc </a></li>
									<li><a href="../jdiff/changes.html" title="API Diffs">API Diffs </a></li>
									<li><a href="../dependencies.html" title="Dependency Information">Dependency Information </a></li>
									<li><a href="http://github.com/cloudera/cdk-examples" title="Examples" class="externalLink">Examples </a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Modules <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="../cdk-data/index.html" title="CDK Data">CDK Data </a></li>
									<li><a href="../cdk-maven-plugin/index.html" title="CDK Maven Plugin">CDK Maven Plugin </a></li>
									<li><a href="index.html" title="CDK Morphlines">CDK Morphlines </a></li>
									<li><a href="../cdk-tools/index.html" title="CDK Tools">CDK Tools </a></li>
								</ul>
							</li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">CDK Morphlines <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="index.html" title="Home">Home </a></li>
									<li class="active"><a href="" title="Morphlines Reference Guide">Morphlines Reference Guide </a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Contribute <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="http://github.com/cloudera/cdk" title="Source Repository" class="externalLink">Source Repository </a></li>
									<li><a href="https://issues.cloudera.org/browse/CDK" title="JIRA" class="externalLink">JIRA </a></li>
									<li><a href="https://groups.google.com/a/cloudera.org/forum/#!forum/cdk-dev" title="Mailing List" class="externalLink">Mailing List </a></li>
									<li><a href="../how_to_contribute.html" title="How To Contribute">How To Contribute </a></li>
									<li><a href="../adding_a_module.html" title="Adding a Module">Adding a Module </a></li>
									<li><a href="../project-info.html" title="Project Information">Project Information </a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="Cloudera_Morphlines_Reference_Guide">Cloudera Morphlines Reference Guide</h2>
 </div> 
</div> 
<p>Cloudera Morphlines provides a set of frequently-used high-level transformation and I/O commands that can be combined in application specific ways. The following tables provide a short description of each available command and a link to the complete documentation.</p> 
<div class="section"> 
 <h4 id="Implementing_your_own_Custom_Command">Implementing your own Custom Command</h4> 
</div> 
<p>Before we dive into the <i>currently available</i> commands, it is worth noting again that perhaps the most important property of the Morphlines framework is how easy it is to add new transformations and I/O commands and integrate existing functionality and third party systems. If none of the existing commands match your use case, you can easily write your own command and plug it in. Simply implement the Java interface <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/api/Command.java">Command</a> or subclass <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/base/AbstractCommand.java">AbstractCommand</a>, have it handle a <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/api/Record.java">Record</a> and add the resulting Java class to the classpath, along with a <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/api/CommandBuilder.java">CommandBuilder</a> implementation that defines the name(s) of the command and serves as a factory. Here are two example implementations: <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ToStringBuilder.java">toString</a> and <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdio/ReadLineBuilder.java">readLine</a>. No registration or other administrative action is required. Indeed, none of the standard commands are special or intrinsically known per se. All commands are implemented like this, even including standard commands such as <tt>pipe</tt>, <tt>if</tt>, and <tt>tryRules</tt>. This means your custom commands can even replace any standard commands, if desired. With that said, the following tables provide a short description of each available command and a link to the complete documentation.</p> 
<div class="section"> 
 <h4 id="Table_of_Contents">Table of Contents</h4> 
</div> 
<ul> 
 <li><a href="#cdk-morphlines-core-stdio">cdk-morphlines-core-stdio</a></li> 
 <li><a href="#cdk-morphlines-core-stdlib">cdk-morphlines-core-stdlib</a></li> 
 <li><a href="#cdk-morphlines-avro">cdk-morphlines-avro</a></li> 
 <li><a href="#cdk-morphlines-json">cdk-morphlines-json</a></li> 
 <li><a href="#cdk-morphlines-hadoop-core">cdk-morphlines-hadoop-core</a></li> 
 <li><a href="#cdk-morphlines-hadoop-sequencefile">cdk-morphlines-hadoop-sequencefile</a></li> 
 <li><a href="#cdk-morphlines-hadoop-rcfile">cdk-morphlines-hadoop-rcfile</a></li> 
 <li><a href="#cdk-morphlines-maxmind">cdk-morphlines-maxmind</a></li> 
 <li><a href="#cdk-morphlines-metrics-servlets">cdk-morphlines-metrics-servlets</a></li> 
 <li><a href="#cdk-morphlines-tika-core">cdk-morphlines-tika-core</a></li> 
 <li><a href="#cdk-morphlines-tika-decompress">cdk-morphlines-tika-decompress</a></li> 
 <li><a href="#cdk-morphlines-saxon">cdk-morphlines-saxon</a></li> 
 <li><a href="#cdk-morphlines-solr-core">cdk-morphlines-solr-core</a></li> 
 <li><a href="#cdk-morphlines-solr-cell">cdk-morphlines-solr-cell</a></li> 
 <li><a href="#cdk-morphlines-useragent">cdk-morphlines-useragent</a></li> 
</ul> 
<p><a id="cdk-morphlines-core-stdio"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-core-stdio">cdk-morphlines-core-stdio</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#readClob">readClob</a> </td> 
   <td> Converts a byte stream to a string. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#readCSV">readCSV</a> </td> 
   <td> Extracts zero or more records from the input stream of bytes representing a Comma Separated Values (CSV) file. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#readLine">readLine</a> </td> 
   <td> Emits one record per line in the input stream. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#readMultiLine">readMultiLine</a> </td> 
   <td> Log parser that collapses multiple input lines into a single record, based on regular expression pattern matching. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-core-stdlib"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-core-stdlib">cdk-morphlines-core-stdlib</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#addCurrentTime">addCurrentTime</a> </td> 
   <td> Adds the result of <a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#currentTimeMillis()">System.currentTimeMillis()</a> to a given output field. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#addLocalHost">addLocalHost</a> </td> 
   <td> Adds the name or IP of the local host to a given output field. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#addValues">addValues</a> </td> 
   <td> Adds a list of values (or the contents of another field) to a given field. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#addValuesIfAbsent">addValuesIfAbsent</a> </td> 
   <td> Adds a list of values (or the contents of another field) to a given field if not already contained. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#callParentPipe">callParentPipe</a> </td> 
   <td> Implements recursion for extracting data from container data formats. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#contains">contains</a> </td> 
   <td> Returns whether or not a given value is contained in a given field. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#convertTimestamp">convertTimestamp</a> </td> 
   <td> Converts the timestamps in a given field from one of a set of input date formats to an output date format. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#decodeBase64">decodeBase64</a> </td> 
   <td> Converts a Base64 encoded String to a byte[]. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#dropRecord">dropRecord</a> </td> 
   <td> Silently consumes records without ever emitting any record. Think <tt>/dev/null</tt>. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#equals">equals</a> </td> 
   <td> Succeeds if all field values of the given named fields are equal to the the given values and fails otherwise. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#extractURIComponents">extractURIComponents</a> </td> 
   <td> Extracts subcomponents such as host, port, path, query, etc from a URI. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#extractURIComponent">extractURIComponent</a> </td> 
   <td> Extracts a particular subcomponent from a URI. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#extractURIQueryParameters">extractURIQueryParameters</a> </td> 
   <td> Extracts the query parameters with a given name from a URI. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#findReplace">findReplace</a> </td> 
   <td> Examines each string value in a given field and replaces each substring of the string value that matches the given string literal or grok pattern with the given replacement. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#generateUUID">generateUUID</a> </td> 
   <td> Sets a universally unique identifier on all records that are intercepted. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#grok">grok</a> </td> 
   <td> Uses regular expression pattern matching to extract structured fields from unstructured log or text data. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#if">if</a> </td> 
   <td> Implements if-then-else conditional control flow. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#java">java</a> </td> 
   <td> Scripting support for Java. Dynamically compiles and executes the given Java code block. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#logTrace">logTrace, logDebug, logInfo, logWarn, logError</a> </td> 
   <td> Logs a message at the given log level to <a class="externalLink" href="http://www.slf4j.org">SLF4J</a>. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#not">not</a> </td> 
   <td> Inverts the boolean return value of a nested command. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#pipe">pipe</a> </td> 
   <td> Pipes a record through a chain of commands. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#separateAttachments">separateAttachments</a> </td> 
   <td> Emits one separate output record for each attachment in the input record's list of attachments. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#setValues">setValues</a> </td> 
   <td> Assigns a given list of values (or the contents of another field) to a given field. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#split">split</a> </td> 
   <td> Divides a string into substrings, by recognizing a <i>separator</i> (a.k.a. &quot;delimiter&quot;) which can be expressed as a single character, literal string, regular expression, or grok pattern. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#splitKeyValue">splitKeyValue</a> </td> 
   <td> Splits key-value pairs where the key and value are separated by the given separator character, and adds the pair's value to the record field named after the pair's key. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#startReportingMetricsToCSV">startReportingMetricsToCSV</a> </td> 
   <td> Starts periodically appending the metrics of all commands to a set of CSV files. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#startReportingMetricsToJMX">startReportingMetricsToJMX</a> </td> 
   <td> Starts publishing the metrics of all commands to <a class="externalLink" href="http://en.wikipedia.org/wiki/Java_Management_Extensions">JMX</a>. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#startReportingMetricsToSLF4J">startReportingMetricsToSLF4J</a> </td> 
   <td> Starts periodically logging the metrics of all morphline commands to <a class="externalLink" href="http://www.slf4j.org">SLF4J</a>. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#toByteArray">toByteArray</a> </td> 
   <td> Converts a String to the byte array representation of a given charset. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#toString">toString</a> </td> 
   <td> Converts a Java object to it's string representation; optionally also removes leading and trailing whitespace. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#translate">translate</a> </td> 
   <td> Replace a string with the replacement value defined in a given dictionary aka lookup hash table. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#tryRules">tryRules</a> </td> 
   <td> Simple rule engine for handling a list of heterogeneous input data formats. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-avro"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-avro">cdk-morphlines-avro</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#readAvroContainer">readAvroContainer</a> </td> 
   <td> Parses an Apache Avro binary container and emits a morphline record for each contained Avro datum. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#readAvro">readAvro</a> </td> 
   <td> Parses containerless Avro and emits a morphline record for each contained Avro datum. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#extractAvroTree">extractAvroTree</a> </td> 
   <td> Recursively walks an Avro tree and extracts all data into a single morphline record. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#extractAvroPaths">extractAvroPaths</a> </td> 
   <td> Extracts specific values from an Avro object, akin to a simple form of XPath. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#toAvro">toAvro</a> </td> 
   <td> Converts a morphline record to an Avro record. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#writeAvroToByteArray">writeAvroToByteArray</a> </td> 
   <td> Serializes Avro records into a byte array. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-json"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-json">cdk-morphlines-json</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#readJson">readJson</a> </td> 
   <td> Parses JSON and emits a morphline record for each contained JSON object, using the <a class="externalLink" href="https://github.com/FasterXML/jackson-databind">Jackson</a> library. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#extractJsonPaths">extractJsonPaths</a> </td> 
   <td> Extracts specific values from a JSON object, akin to a simple form of XPath. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-hadoop-core"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-hadoop-core">cdk-morphlines-hadoop-core</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#downloadHdfsFile">downloadHdfsFile</a> </td> 
   <td> Downloads, on startup, zero or more files or directory trees from HDFS to the local file system. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-hadoop-sequencefile"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-hadoop-sequencefile">cdk-morphlines-hadoop-sequencefile</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#readSequenceFile">readSequenceFile</a> </td> 
   <td> Parses an Apache Hadoop <a class="externalLink" href="http://archive.cloudera.com/cdh4/cdh/4/hadoop/api/org/apache/hadoop/io/SequenceFile.html">SequenceFile</a> and emits a morphline record for each contained key-value pair. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-hadoop-rcfile"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-hadoop-rcfile">cdk-morphlines-hadoop-rcfile</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#readRCFile">readRCFile</a> </td> 
   <td> Parses an Apache Hadoop <a class="externalLink" href="http://archive.cloudera.com/cdh4/cdh/4/hive/api/org/apache/hadoop/hive/ql/io/RCFile.html">RCFile</a> and emits morphline records row-wise or column-wise. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-maxmind"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-maxmind">cdk-morphlines-maxmind</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#geoIP">geoIP</a> </td> 
   <td> Returns Geolocation information for a given IP address, using an efficient in-memory Maxmind database lookup. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-metrics-servlets"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-metrics-servlets">cdk-morphlines-metrics-servlets</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#registerJVMMetrics">registerJVMMetrics</a> </td> 
   <td> Registers metrics that are related to the Java Virtual Machine with the MorphlineContext. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#startReportingMetricsToHTTP">startReportingMetricsToHTTP</a> </td> 
   <td> Exposes liveness status, health check status, metrics state and thread dumps via a set of HTTP URLs served by Jetty, using the AdminServlet. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-tika-core"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-tika-core">cdk-morphlines-tika-core</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#detectMimeType">detectMimeType</a> </td> 
   <td> Uses Apache Tika to autodetect the <a class="externalLink" href="https://en.wikipedia.org/wiki/Internet_media_type">MIME type</a> of binary data. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-tika-decompress"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-tika-decompress">cdk-morphlines-tika-decompress</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#decompress">decompress</a> </td> 
   <td> Decompresses gzip and bzip2 format. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#unpack">unpack</a> </td> 
   <td> Unpacks tar, zip, and jar format. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-saxon"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-saxon">cdk-morphlines-saxon</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#convertHTML">convertHTML</a> </td> 
   <td> Converts any HTML to XHTML, using the <a class="externalLink" href="http://ccil.org/~cowan/XML/tagsoup">TagSoup</a> Java library. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#xquery">xquery</a> </td> 
   <td> Parses XML and runs the given W3C XQuery over it, using the <a class="externalLink" href="http://www.saxonica.com">Saxon</a> Java library. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#xslt">xslt</a> </td> 
   <td> Parses XML and runs the given W3C XSL Transform over it, using the <a class="externalLink" href="http://www.saxonica.com">Saxon</a> Java library. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-solr-core"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-solr-core">cdk-morphlines-solr-core</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#solrLocator">solrLocator</a> </td> 
   <td> Specifies a set of configuration parameters that identify the location and schema of a Solr server or SolrCloud. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#loadSolr">loadSolr</a> </td> 
   <td> Loads a record into a Solr server or MapReduce Reducer. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#generateSolrSequenceKey">generateSolrSequenceKey</a> </td> 
   <td> Assigns a unique key that is the concatenation of a field and a running count of the record number within the current session. </td> 
  </tr> 
  <tr class="b"> 
   <td> <a href="#sanitizeUnknownSolrFields">sanitizeUnknownSolrFields</a> </td> 
   <td> Removes record fields that are unknown to Solr <tt>schema.xml</tt>, or moves them to fields with a given prefix. </td> 
  </tr> 
  <tr class="a"> 
   <td> <a href="#tokenizeText">tokenizeText</a> </td> 
   <td> Uses the embedded <a class="externalLink" href="http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters">Solr/Lucene Analyzer library</a> to generate tokens from a text string, without sending data to a Solr server. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-solr-cell"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-solr-cell">cdk-morphlines-solr-cell</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#solrCell">solrCell</a> </td> 
   <td> Uses Apache <a class="externalLink" href="http://tika.apache.org">Tika</a> to parse data, then maps the Tika output back to a record using Apache SolrCell. </td> 
  </tr> 
 </tbody> 
</table> 
<p><a id="cdk-morphlines-useragent"></a> <br /> <br /></p> 
<div class="section"> 
 <h4 id="cdk-morphlines-useragent">cdk-morphlines-useragent</h4> 
</div> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> <a href="#userAgent">userAgent</a> </td> 
   <td> Parses a user agent string and returns structured higher level data like user agent family, operating system, version, and device type. </td> 
  </tr> 
 </tbody> 
</table> 
<p><br /> <br /></p> 
<div class="section"> 
 <h2 id="cdk-morphlines-core-stdio">cdk-morphlines-core-stdio</h2> 
</div> 
<p>This maven module contains standard I/O commands for tasks such as acting on single-line records, multi-line records, CSV files, and for converting bytes to strings.</p> 
<div class="section"> 
 <h3 id="readClob">readClob</h3> 
</div> 
<p>The <tt>readClob</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdio/ReadClobBuilder.java">source code</a>) converts bytes to a string. It emits one record for the entire input stream of the first attachment, interpreting the stream as a Character Large Object (CLOB). The line is put as a string into the <tt>message</tt> output field.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> supportedMimeTypes </td> 
   <td> null </td> 
   <td> Optionally, require the input record to match one of the MIME types in this list. </td> 
  </tr> 
  <tr class="a"> 
   <td> charset </td> 
   <td> null </td> 
   <td> The character encoding to use, for example, UTF-8. If none is specified the charset specified in the _attachment_charset input field is used instead. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>readClob {
  charset : UTF-8
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="readCSV">readCSV</h3> 
</div> 
<p>The <tt>readCSV</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdio/ReadCSVBuilder.java">source code</a>) extracts zero or more records from the input stream of the first attachment of the record, representing a Comma Separated Values (CSV) file.</p> 
<p>For the format see this <a class="externalLink" href="http://www.creativyst.com/Doc/Articles/CSV/CSV01.htm">article</a>.</p> 
<p>Some CSV files contain a header line that contains embedded column names. This command does not support reading and using such embedded column names as output field names because this is considered unreliable for production systems. If the first line of the CSV file is a header line, you must set the <tt>ignoreFirstLine</tt> option to true. You must explicitly define the <tt>columns</tt> configuration parameter in order to name the output fields.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> supportedMimeTypes </td> 
   <td> null </td> 
   <td> Optionally, require the input record to match one of the MIME types in this list. </td> 
  </tr> 
  <tr class="a"> 
   <td> separator </td> 
   <td> &quot;,&quot; </td> 
   <td> The character separating any two fields. </td> 
  </tr> 
  <tr class="b"> 
   <td> columns </td> 
   <td> n/a </td> 
   <td> The name of the output fields for each input column. An empty string indicates omit this column in the output. If more columns are contained in the input than specified here, those columns are automatically named <tt>columnN</tt>. </td> 
  </tr> 
  <tr class="a"> 
   <td> ignoreFirstLine </td> 
   <td> false </td> 
   <td> Whether to ignore the first line. This flag can be used for CSV files that contain a header line. </td> 
  </tr> 
  <tr class="b"> 
   <td> trim </td> 
   <td> true </td> 
   <td> Whether leading and trailing whitespace shall be removed from the output fields. </td> 
  </tr> 
  <tr class="a"> 
   <td> addEmptyStrings </td> 
   <td> true </td> 
   <td> Whether or not to add zero length strings to the output fields. </td> 
  </tr> 
  <tr class="b"> 
   <td> charset </td> 
   <td> null </td> 
   <td> The character encoding to use, for example, UTF-8. If none is specified the charset specified in the _attachment_charset input field is used instead. </td> 
  </tr> 
  <tr class="a"> 
   <td> quoteChar </td> 
   <td> &quot;&quot; </td> 
   <td> Must be a string of length zero or one. If this parameter is a String containing a single character then a quoted field can span multiple lines in the input stream. To disable quoting and multiline fields set this parameter to the empty string <tt>&quot;&quot;</tt>. </td> 
  </tr> 
  <tr class="b"> 
   <td> commentPrefix </td> 
   <td> &quot;&quot; </td> 
   <td> Must be a string of length zero or one, for example &quot;#&quot;. If this parameter is a String containing a single character then lines starting with that character are ignored as comments. To disable the comment line feature set this parameter to the empty string <tt>&quot;&quot;</tt>. </td> 
  </tr> 
 </tbody> 
</table> 
<p>If the parameter <tt>quoteChar</tt> is a String containing a single character then a quoted field can span multiple lines in the input stream, for example as shown in the following example CSV input containing a single record with three columns:</p> 
<div class="source"> 
 <pre>column0,&quot;Look, new hot tub under redwood tree!
All bubbly!&quot;,column2
</pre> 
</div> 
<p>The above example can be parsed by specifying a double-quote character for the parameter <tt>quoteChar</tt>, using backslash syntax per the <a class="externalLink" href="http://www.json.org">JSON specification</a>, as follows:</p> 
<div class="source"> 
 <pre>readCSV {
  ...
  quoteChar : &quot;\&quot;&quot;
</pre> 
</div> 
<p>If the parameter <tt>commentPrefix</tt> is a String containing a single character then lines starting with that character are ignored as comments. Example:</p> 
<div class="source"> 
 <pre>#This is a comment line. It is ignored.
</pre> 
</div> 
<p>Example usage for CSV (Comma Separated Values):</p> 
<div class="source"> 
 <pre>readCSV {
  separator : &quot;,&quot;
  columns : [Age,&quot;&quot;,Extras,Type]
  ignoreFirstLine : false
  quoteChar : &quot;&quot;
  commentPrefix : &quot;&quot;
  trim : true
  charset : UTF-8
}
</pre> 
</div> 
<p>Example usage for TSV (Tab Separated Values):</p> 
<div class="source"> 
 <pre>readCSV {
  separator : &quot;\t&quot;
  columns : [Age,&quot;&quot;,Extras,Type]
  ignoreFirstLine : false
  quoteChar : &quot;&quot;
  commentPrefix : &quot;&quot;
  trim : true
  charset : UTF-8
}
</pre> 
</div> 
<p>Example usage for SSV (Space Separated Values):</p> 
<div class="source"> 
 <pre>readCSV {
  separator : &quot; &quot;
  columns : [Age,&quot;&quot;,Extras,Type]
  ignoreFirstLine : false
  quoteChar : &quot;&quot;
  commentPrefix : &quot;&quot;
  trim : true
  charset : UTF-8
}
</pre> 
</div> 
<p>Example usage for Apache Hive (Values separated by non-printable CTRL-A character):</p> 
<div class="source"> 
 <pre>readCSV {
  separator : &quot;\u0001&quot; # non-printable CTRL-A character
  columns : [Age,&quot;&quot;,Extras,Type]
  ignoreFirstLine : false
  quoteChar : &quot;&quot;
  commentPrefix : &quot;&quot;
  trim : false
  charset : UTF-8
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="readLine">readLine</h3> 
</div> 
<p>The <tt>readLine</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdio/ReadLineBuilder.java">source code</a>) emits one record per line in the input stream of the first attachment. The line is put as a string into the <tt>message</tt> output field. Empty lines are ignored.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> supportedMimeTypes </td> 
   <td> null </td> 
   <td> Optionally, require the input record to match one of the MIME types in this list. </td> 
  </tr> 
  <tr class="a"> 
   <td> ignoreFirstLine </td> 
   <td> false </td> 
   <td> Whether to ignore the first line. This flag can be used for CSV files that contain a header line. </td> 
  </tr> 
  <tr class="b"> 
   <td> commentPrefix </td> 
   <td> &quot;&quot; </td> 
   <td> A character that indicates to ignore this line as a comment 
    <s></s> for example, &quot;#&quot;. To disable the comment line feature set this parameter to the empty string <tt>&quot;&quot;</tt>. </td> 
  </tr> 
  <tr class="a"> 
   <td> charset </td> 
   <td> null </td> 
   <td> The character encoding to use, for example, UTF-8. If none is specified the charset specified in the _attachment_charset input field is used instead. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>readLine {
  ignoreFirstLine : true
  commentPrefix : &quot;#&quot;
  charset : UTF-8
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="readMultiLine">readMultiLine</h3> 
</div> 
<p>The <tt>readMultiLine</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdio/ReadMultiLineBuilder.java">source code</a>) is a multiline log parser that collapses multiple input lines into a single record, based on regular expression pattern matching. It supports <tt>regex</tt>, <tt>what</tt>, and <tt>negate</tt> configuration parameters similar to logstash. The line is put as a string into the <tt>message</tt> output field.</p> 
<p>For example, this can be used to parse log4j with stack traces. Also see <a class="externalLink" href="https://gist.github.com/smougenot/3182192">https://gist.github.com/smougenot/3182192</a> and <a class="externalLink" href="http://logstash.net/docs/1.1.13/filters/multiline">http://logstash.net/docs/1.1.13/filters/multiline</a>.</p> 
<p>The input stream or byte array is read from the first attachment of the input record.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> supportedMimeTypes </td> 
   <td> null </td> 
   <td> Optionally, require the input record to match one of the MIME types in this list. </td> 
  </tr> 
  <tr class="a"> 
   <td> regex </td> 
   <td> n/a </td> 
   <td> This parameter should match what you believe to be an indicator that the line is part of a multi-line record. </td> 
  </tr> 
  <tr class="b"> 
   <td> what </td> 
   <td> previous </td> 
   <td> This parameter must be one of &quot;previous&quot; or &quot;next&quot; and indicates the relation of the regex to the multi-line record. </td> 
  </tr> 
  <tr class="a"> 
   <td> negate </td> 
   <td> false </td> 
   <td> This parameter can be true or false. If true, a line not matching the regex constitutes a match of the multiline filter and the previous or next action is applied. The reverse is also true. </td> 
  </tr> 
  <tr class="b"> 
   <td> charset </td> 
   <td> null </td> 
   <td> The character encoding to use, for example, UTF-8. If none is specified the charset specified in the _attachment_charset input field is used instead. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre># parse log4j with stack traces
readMultiLine {
  regex : &quot;(^.+Exception: .+)|(^\\s+at .+)|(^\\s+\\.\\.\\. \\d+ more)|(^\\s*Caused by:.+)&quot;
  what : previous
  charset : UTF-8
}

# parse sessions; begin new record when we find a line that starts with &quot;Started session&quot;
readMultiLine {
  regex : &quot;Started session.*&quot;
  what : next
  charset : UTF-8
}

</pre> 
</div> 
<div class="section"> 
 <h2 id="cdk-morphlines-core-stdlib">cdk-morphlines-core-stdlib</h2> 
</div> 
<p>This maven module contains standard transformation commands, such as commands for flexible log file analysis, regular expression based pattern matching and extraction, operations on fields for assignment and comparison, operations on fields with list and set semantics, if-then-else conditionals, string and timestamp conversions, scripting support for dynamic java code, a small rules engine, logging, and metrics and counters.</p> 
<div class="section"> 
 <h3 id="addCurrentTime">addCurrentTime</h3> 
</div> 
<p>The <tt>addCurrentTime</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/AddCurrentTimeBuilder.java">source code</a>) adds the result of <a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#currentTimeMillis()">System.currentTimeMillis()</a> as a Long integer to a given output field. Typically, a <a href="#convertTimestamp">convertTimestamp</a> command is subsequently used to convert this timestamp to an application specific output format.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> field </td> 
   <td> timestamp </td> 
   <td> The name of the field to set. </td> 
  </tr> 
  <tr class="a"> 
   <td> preserveExisting </td> 
   <td> true </td> 
   <td> Whether to preserve the field value if one is already present. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>addCurrentTime {}
</pre> 
</div> 
<div class="section"> 
 <h3 id="addLocalHost">addLocalHost</h3> 
</div> 
<p>The <tt>addLocalHost</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/AddLocalHostBuilder.java">source code</a>) adds the name or IP of the local host to a given output field.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> field </td> 
   <td> host </td> 
   <td> The name of the field to set. </td> 
  </tr> 
  <tr class="a"> 
   <td> preserveExisting </td> 
   <td> true </td> 
   <td> Whether to preserve the field value if one is already present. </td> 
  </tr> 
  <tr class="b"> 
   <td> useIP </td> 
   <td> true </td> 
   <td> Whether to add the IP address or fully-qualified hostname. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>addLocalHost {
  field : my_host
  useIP : false
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="addValues">addValues</h3> 
</div> 
<p>The <tt>addValues</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/AddValuesBuilder.java">source code</a>) adds a list of values (or the contents of another field) to a given field. The command takes a set of <tt>outputField : values</tt> pairs and performs the following steps: For each output field, adds the given values to the field. The command can fetch the values of a record field using a <i>field expression</i>, which is a string of the form @{fieldname}.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>addValues {
  # add values &quot;text/log&quot; and &quot;text/log2&quot; to the source_type output field
  source_type : [text/log, text/log2]

  # add integer 123 to the pid field
  pid : [123]

  # add all values contained in the first_name field to the name field
  name : &quot;@{first_name}&quot;
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="addValuesIfAbsent">addValuesIfAbsent</h3> 
</div> 
<p>The <tt>addValuesIfAbsent</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/AddValuesIfAbsentBuilder.java">source code</a>) adds a list of values (or the contents of another field) to a given field if not already contained. This command is the same as the <a href="#addValues">addValues</a> command, except that a given value is only added to the output field if it is not already contained in the output field.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>addValuesIfAbsent {
  # add values &quot;text/log&quot; and &quot;text/log2&quot; to the source_type output field
  # unless already present
  source_type : [text/log, text/log2]

  # add integer 123 to the pid field, unless already present
  pid : [123]

  # add all values contained in the first_name field to the name field
  # unless already present
  name : &quot;@{first_name}&quot;
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="callParentPipe">callParentPipe</h3> 
</div> 
<p>The <tt>callParentPipe</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/CallParentPipeBuilder.java">source code</a>) implements recursion for extracting data from container data formats. The command routes records to the enclosing pipe object. Recall that a morphline <i>is a</i> pipe. Thus, unless a morphline contains nested pipes, the parent pipe of a given command is the morphline itself, meaning that the first command of the morphline is called with the given record. Thus, the <tt>callParentPipe</tt> command effectively implements recursion, which is useful for extracting data from container data formats in elegant and concise ways. For example, you could use this to extract data from tar.gz files. This command is typically used in combination with the commands <tt>detectMimeType</tt>, <tt>tryRules</tt>, <tt>decompress</tt>, <tt>unpack</tt>, and possibly <tt>solrCell</tt>.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>callParentPipe {}
</pre> 
</div> 
<p>For a real world example, see the <tt>solrCell</tt> command.</p> 
<div class="section"> 
 <h3 id="contains">contains</h3> 
</div> 
<p>The <tt>contains</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ContainsBuilder.java">source code</a>) returns whether or not a given value is contained in a given field. The command succeeds if one of the field values of the given named field is equal to one of the the given values, and fails otherwise. Multiple fields can be named, in which case the results are ANDed.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre># succeed if the _attachment_mimetype field contains a value &quot;avro/binary&quot;
# fail otherwise
contains { _attachment_mimetype : [avro/binary] }

# succeed if the tags field contains a value &quot;version1&quot; or &quot;version2&quot;,
# fail otherwise
contains { tags : [version1, version2] }
</pre> 
</div> 
<div class="section"> 
 <h3 id="convertTimestamp">convertTimestamp</h3> 
</div> 
<p>The <tt>convertTimestamp</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ConvertTimestampBuilder.java">source code</a>) converts the timestamps in a given field from one of a set of input date formats (in an input timezone) to an output date format (in an output timezone), while respecting daylight savings time rules. The command provides reasonable defaults for common use cases.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> field </td> 
   <td> timestamp </td> 
   <td> The name of the field to convert. </td> 
  </tr> 
  <tr class="a"> 
   <td> inputFormats </td> 
   <td> A list of common input date formats </td> 
   <td> A list of <a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">SimpleDateFormat</a> or &quot;unixTimeInMillis&quot; or &quot;unixTimeInSeconds&quot;. &quot;unixTimeInMillis&quot; and &quot;unixTimeInSeconds&quot; indicate the difference, measured in milliseconds and seconds, respectively, between a timestamp and midnight, January 1, 1970 UTC. Multiple input date formats can be specified. If none of the input formats match the field value then the command fails.</td> 
  </tr> 
  <tr class="b"> 
   <td> inputTimezone </td> 
   <td> UTC </td> 
   <td> The time zone to assume for the input timestamp. </td> 
  </tr> 
  <tr class="a"> 
   <td> inputLocale </td> 
   <td> &quot;&quot; </td> 
   <td> The Java Locale to assume for the input timestamp. </td> 
  </tr> 
  <tr class="b"> 
   <td> outputFormat </td> 
   <td> &quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot; </td> 
   <td> The <a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">SimpleDateFormat</a> to which to convert. Can also be &quot;unixTimeInMillis&quot; or &quot;unixTimeInSeconds&quot;. &quot;unixTimeInMillis&quot; and &quot;unixTimeInSeconds&quot; indicate the difference, measured in milliseconds and seconds, respectively, between a timestamp and midnight, January 1, 1970 UTC. </td> 
  </tr> 
  <tr class="a"> 
   <td> outputTimezone </td> 
   <td> UTC </td> 
   <td> The time zone to assume for the output timestamp. </td> 
  </tr> 
  <tr class="b"> 
   <td> outputLocale </td> 
   <td> &quot;&quot; </td> 
   <td> The Java Locale to assume for the output timestamp. </td> 
  </tr> 
 </tbody> 
</table> 
<div class="section"> 
 <h5 id="Example_usage_with_plain_SimpleDateFormat">Example usage with plain SimpleDateFormat</h5> 
</div> 
<div class="source"> 
 <pre># convert the timestamp field to &quot;yyyy-MM-dd'T'HH:mm:ss.SSSZ&quot;
# The input may match one of &quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot;
# or &quot;yyyy-MM-dd'T'HH:mm:ss&quot; or &quot;yyyy-MM-dd&quot;.
convertTimestamp {
  field : timestamp
  inputFormats : [&quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot;, &quot;yyyy-MM-dd'T'HH:mm:ss&quot;, &quot;yyyy-MM-dd&quot;]
  inputTimezone : America/Los_Angeles
  outputFormat : &quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot;
  outputTimezone : UTC
}
</pre> 
</div> 
<div class="section"> 
 <h5 id="Example_usage_with_Solr_date_rounding">Example usage with Solr date rounding</h5> 
</div> 
<p>A SimpleDateFormat can also contain a literal string for <a class="externalLink" href="http://java.dzone.com/articles/solr-date-math-now-and-filter">Solr date rounding</a> down to, say, the current hour, minute or second. For example: <tt>'/MINUTE'</tt> to round to the current minute. This kind of rounding results in fewer distinct values and improves the performance of Solr several ways:</p> 
<ul> 
 <li>it uses less memory for many functions, e.g. sorting by time, restricting by date ranges etc.</li> 
 <li>it improves speed of range queries based on time, e.g. &quot;restrict documents to those from the last 7 days&quot;</li> 
 <li>In the case of faceting by the values in the field it will improve both memory requirements and speed.</li> 
</ul> 
<p>For these reasons, it's advisable to store dates in the coarsest granularity that's appropriate for your application.</p> 
<p>Example usage with Solr date rounding:</p> 
<div class="source"> 
 <pre># convert the timestamp field to &quot;yyyy-MM-dd'T'HH:mm:ss.SSSZ&quot;
# and indicate to Solr that it shall round the time down to the current minute
# per http://lucene.apache.org/solr/4_4_0/solr-core/org/apache/solr/util/DateMathParser.html
convertTimestamp {
  ...
  outputFormat : &quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z/MINUTE'&quot;
  ...
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="decodeBase64">decodeBase64</h3> 
</div> 
<p>The <tt>decodeBase64</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/DecodeBase64Builder.java">source code</a>) converts a Base64 encoded String to a byte[] per Section 6.8. &quot;Base64 Content-Transfer-Encoding&quot; of <a class="externalLink" href="http://www.ietf.org/rfc/rfc2045.txt">RFC 2045</a>. The command converts each value in the given field and replaces it with the decoded value.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> field </td> 
   <td> n/a </td> 
   <td> The name of the field to modify. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>decodeBase64 { 
  field : screenshot_base64
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="dropRecord">dropRecord</h3> 
</div> 
<p>The <tt>dropRecord</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/DropRecordBuilder.java">source code</a>) silently consumes records without ever emitting any record. This is much like piping to <tt>/dev/null</tt> in Unix.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>dropRecord {}
</pre> 
</div> 
<div class="section"> 
 <h3 id="equals">equals</h3> 
</div> 
<p>The <tt>equals</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/EqualsBuilder.java">source code</a>) succeeds if all field values of the given named fields are equal to the the given values and fails otherwise. Multiple fields can be named, in which case a logical AND is applied to the results.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre># succeed if the _attachment_mimetype field contains the value &quot;avro/binary&quot;
# and nothing else, fail otherwise
equals { _attachment_mimetype : [avro/binary] }

# succeed if the tags field contains nothing but the values &quot;version1&quot;
# and &quot;highPriority&quot;, in that order, fail otherwise
equals { tags : [version1, highPriority] }
</pre> 
</div> 
<div class="section"> 
 <h3 id="extractURIComponents">extractURIComponents</h3> 
</div> 
<p>The <tt>extractURIComponents</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ExtractURIComponentsBuilder.java">source code</a>) extracts the following subcomponents from the URIs contained in the given input field and adds them to output fields with the given prefix: scheme, authority, host, port, path, query, fragment, schemeSpecificPart, userInfo.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> inputField </td> 
   <td> n/a </td> 
   <td> The name of the input field that contains zero or more URIs. </td> 
  </tr> 
  <tr class="a"> 
   <td> outputFieldPrefix </td> 
   <td> &quot;&quot; </td> 
   <td> A prefix to prepend to output field names. </td> 
  </tr> 
  <tr class="b"> 
   <td> failOnInvalidURI </td> 
   <td> false </td> 
   <td> If an URI is syntactically invalid (i.e. throws a <tt>URISyntaxException</tt> on parsing), fail the command (<tt>true</tt>) or ignore this URI (<tt>false</tt>). </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>extractURIComponents {
  inputField : my_uri
  outputFieldPrefix : uri_component_
}
</pre> 
</div> 
<p>For example, given the input field <tt>myUri</tt> with the value <tt>http://userinfo@www.bar.com:8080/errors.log?foo=x&amp;bar=y&amp;foo=z#fragment</tt> the expected output is as follows:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Name </b></th> 
   <th><b> Value </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> myUri </td> 
   <td> http://userinfo@www.bar.com:8080/errors.log?foo=x&amp;bar=y&amp;foo=z#fragment </td> 
  </tr> 
  <tr class="a"> 
   <td> uri_component_authority </td> 
   <td> userinfo@www.bar.com:8080 </td> 
  </tr> 
  <tr class="b"> 
   <td> uri_component_fragment </td> 
   <td> fragment </td> 
  </tr> 
  <tr class="a"> 
   <td> uri_component_host </td> 
   <td> www.bar.com </td> 
  </tr> 
  <tr class="b"> 
   <td> uri_component_path </td> 
   <td> /errors.log </td> 
  </tr> 
  <tr class="a"> 
   <td> uri_component_port </td> 
   <td> 8080 </td> 
  </tr> 
  <tr class="b"> 
   <td> uri_component_query </td> 
   <td> foo=x&amp;bar=y&amp;foo=z </td> 
  </tr> 
  <tr class="a"> 
   <td> uri_component_scheme </td> 
   <td> http </td> 
  </tr> 
  <tr class="b"> 
   <td> uri_component_schemeSpecificPart </td> 
   <td> //userinfo@www.bar.com:8080/errors.log?foo=x&amp;bar=y&amp;foo=z </td> 
  </tr> 
  <tr class="a"> 
   <td> uri_component_userInfo </td> 
   <td> userinfo </td> 
  </tr> 
 </tbody> 
</table> 
<div class="section"> 
 <h3 id="extractURIComponent">extractURIComponent</h3> 
</div> 
<p>The <tt>extractURIComponent</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ExtractURIComponentBuilder.java">source code</a>) extracts a subcomponent from the URIs contained in the given input field and adds it to the given output field. This is the same as the <a href="#extractURIComponents">extractURIComponents</a> command, except that only one component is extracted.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> inputField </td> 
   <td> n/a </td> 
   <td> The name of the input field that contains zero or more URIs. </td> 
  </tr> 
  <tr class="a"> 
   <td> outputField </td> 
   <td> n/a </td> 
   <td> The field to add output values to. </td> 
  </tr> 
  <tr class="b"> 
   <td> failOnInvalidURI </td> 
   <td> false </td> 
   <td> If an URI is syntactically invalid (i.e. throws a <tt>URISyntaxException</tt> on parsing), fail the command (<tt>true</tt>) or ignore this URI (<tt>false</tt>). </td> 
  </tr> 
  <tr class="a"> 
   <td> component </td> 
   <td> n/a </td> 
   <td> The type of information to extract. Can be one of <tt>scheme</tt>, <tt>authority</tt>, <tt>host</tt>, <tt>port</tt>, <tt>path</tt>, <tt>query</tt>, <tt>fragment</tt>, <tt>schemeSpecificPart</tt>, <tt>userInfo</tt> </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>extractURIComponent {
  inputField : my_uri
  outputField : my_scheme
  component : scheme
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="extractURIQueryParameters">extractURIQueryParameters</h3> 
</div> 
<p>The <tt>extractURIQueryParameters</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ExtractURIQueryParametersBuilder.java">source code</a>) extracts the query parameters with a given name from the URIs contained in the given input field and appends them to the given output field.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> parameter </td> 
   <td> n/a </td> 
   <td> The name of the query parameter to find. </td> 
  </tr> 
  <tr class="a"> 
   <td> inputField </td> 
   <td> n/a </td> 
   <td> The name of the input field that contains zero or more URI values. </td> 
  </tr> 
  <tr class="b"> 
   <td> outputField </td> 
   <td> n/a </td> 
   <td> The field to add output values to. </td> 
  </tr> 
  <tr class="a"> 
   <td> failOnInvalidURI </td> 
   <td> false </td> 
   <td> If an URI is syntactically invalid (i.e. throws a <tt>URISyntaxException</tt> on parsing), fail the command (<tt>true</tt>) or ignore this URI (<tt>false</tt>). </td> 
  </tr> 
  <tr class="b"> 
   <td> maxParameters </td> 
   <td> 1000000000 </td> 
   <td> The maximum number of values to append to the output field per input field. </td> 
  </tr> 
  <tr class="a"> 
   <td> charset </td> 
   <td> UTF-8 </td> 
   <td> The character encoding to use, for example, UTF-8. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>extractURIQueryParameters {
  parameter : foo
  inputField : myUri
  outputField : my_query_params
}
</pre> 
</div> 
<p>For example, given the input field <tt>myUri</tt> with the value <tt>http://userinfo@www.bar.com/errors.log?foo=x&amp;bar=y&amp;foo=z#fragment</tt> the expected output record is:</p> 
<div class="source"> 
 <pre>my_query_params:x
my_query_params:z
</pre> 
</div> 
<div class="section"> 
 <h3 id="findReplace">findReplace</h3> 
</div> 
<p>The <tt>findReplace</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/FindReplaceBuilder.java">source code</a>) examines each string value in a given field and replaces each substring of the string value that matches the given string literal or grok pattern with the given replacement.</p> 
<p>This command also supports grok dictionaries and regexes in the same way as the <a href="#grok">grok</a> command.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> field </td> 
   <td> n/a </td> 
   <td> The name of the field to modify. </td> 
  </tr> 
  <tr class="a"> 
   <td> pattern </td> 
   <td> n/a </td> 
   <td> The search string to match. </td> 
  </tr> 
  <tr class="b"> 
   <td> isRegex </td> 
   <td> false </td> 
   <td> Whether or not to interpret the pattern as a grok pattern (true) or string literal (false). </td> 
  </tr> 
  <tr class="a"> 
   <td> dictionaryFiles </td> 
   <td> [] </td> 
   <td> A list of zero or more local files or directory trees from which to load dictionaries. Only applicable if <tt>isRegex</tt> is <tt>true</tt>. See <a href="#grok">grok</a> command. </td> 
  </tr> 
  <tr class="b"> 
   <td> dictionaryString </td> 
   <td> null </td> 
   <td> An optional inline string from which to load a dictionary. Only applicable if <tt>isRegex</tt> is <tt>true</tt>. See <a href="#grok">grok</a> command. </td> 
  </tr> 
  <tr class="a"> 
   <td> replacement </td> 
   <td> n/a </td> 
   <td> The replacement pattern (<tt>isRegex</tt> is <tt>true</tt>) or string literal (<tt>isRegex</tt> is <tt>false</tt>). </td> 
  </tr> 
  <tr class="b"> 
   <td> replaceFirst </td> 
   <td> false </td> 
   <td> For each field value, whether or not to skip any matches beyond the first match. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage with grok pattern:</p> 
<div class="source"> 
 <pre>findReplace { 
  field : message
  dictionaryFiles : [cdk-morphlines-core/src/test/resources/grok-dictionaries]                               
  pattern : &quot;&quot;&quot;%{WORD:myGroup}&quot;&quot;&quot;
  #pattern : &quot;&quot;&quot;(\b\w+\b)&quot;&quot;&quot;      
  isRegex : true
  replacement : &quot;${myGroup}!&quot;
  #replacement : &quot;$1!&quot;
  #replacement : &quot;&quot;
  replaceFirst : false
}
</pre> 
</div> 
<p>Input: <tt>&quot;hello world&quot;</tt></p> 
<p>Expected output: <tt>&quot;hello! world!&quot;</tt></p> 
<div class="section"> 
 <h3 id="generateUUID">generateUUID</h3> 
</div> 
<p>The <tt>generateUUID</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/GenerateUUIDBuilder.java">source code</a>) sets a universally unique identifier on all records that are intercepted. An example UUID is b5755073-77a9-43c1-8fad-b7a586fc1b97, which represents a 128bit value.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> field </td> 
   <td> id </td> 
   <td> The name of the field to set. </td> 
  </tr> 
  <tr class="a"> 
   <td> preserveExisting </td> 
   <td> true </td> 
   <td> Whether to preserve the field value if one is already present. </td> 
  </tr> 
  <tr class="b"> 
   <td> prefix </td> 
   <td> &quot;&quot; </td> 
   <td> The prefix string constant to prepend to each generated UUID. </td> 
  </tr> 
  <tr class="a"> 
   <td> type </td> 
   <td> secure </td> 
   <td> This parameter must be one of &quot;secure&quot; or &quot;nonSecure&quot; and indicates the algorithm used for UUID generation. Unfortunately, the cryptographically &quot;secure&quot; algorithm can be comparatively slow - if it uses /dev/random on Linux, it can block waiting for sufficient entropy to build up. In contrast, the &quot;nonSecure&quot; algorithm never blocks and is much faster. The &quot;nonSecure&quot; algorithm uses a secure random seed but is otherwise deterministic, though it is one of the <a class="externalLink" href="http://bit.ly/12H7NHo">strongest uniform pseudo random number generators known so far</a>. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>generateUUID {
  field : my_id
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="grok">grok</h3> 
</div> 
<p>The <tt>grok</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/GrokBuilder.java">source code</a>) uses regular expression pattern matching to extract structured fields from unstructured log data.</p> 
<p>This is well suited for syslog logs, apache, and other webserver logs, mysql logs, and in general, any log format that is generally written for humans and not computer consumption.</p> 
<p>A grok command can load zero or more dictionaries. A dictionary is a file or string that contains zero or more REGEXNAME to REGEX mappings, one per line, separated by space. Here is an example dictionary:</p> 
<div class="source"> 
 <pre>INT (?:[+-]?(?:[0-9]+))
HOSTNAME \b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\.?|\b)
</pre> 
</div> 
<p>In this example, the regex named &quot;INT&quot; is associated with the following <a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html">regex pattern</a>:</p> 
<div class="source"> 
 <pre>[+-]?(?:[0-9]+)
</pre> 
</div> 
<p>and matches strings like &quot;123&quot;, whereas the regex named &quot;HOSTNAME&quot; is associated with the following regex pattern:</p> 
<div class="source"> 
 <pre>\b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\.?|\b)
</pre> 
</div> 
<p>and matches strings like &quot;www.cloudera.com&quot;.</p> 
<p>Morphlines ships with <a class="externalLink" href="https://github.com/cloudera/cdk/tree/master/cdk-morphlines/cdk-morphlines-core/src/test/resources/grok-dictionaries">several standard grok dictionaries</a>.</p> 
<p>A grok command can contain zero or more grok expressions. Each grok expression refers to a record input field name and can contain zero or more grok patterns. The following is an example grok expression that refers to the input field named &quot;message&quot; and contains two grok patterns:</p> 
<div class="source"> 
 <pre>expressions : {
  message : &quot;&quot;&quot;\s+%{INT:pid} %{HOSTNAME:my_name_servers}&quot;&quot;&quot;
}
</pre> 
</div> 
<p>The syntax for a grok pattern is</p> 
<div class="source"> 
 <pre>%{REGEX_NAME:GROUP_NAME}
</pre> 
</div> 
<p>for example</p> 
<div class="source"> 
 <pre>%{INT:pid}
</pre> 
</div> 
<p>or</p> 
<div class="source"> 
 <pre>%{HOSTNAME:my_name_servers}
</pre> 
</div> 
<p>The REGEXNAME is the name of a regex within a loaded dictionary.</p> 
<p>The GROUPNAME is the name of an output field.</p> 
<p>If all expressions of the grok command match the input record, then the command succeeds and the content of the named capturing group is added to this output field of the output record. Otherwise, the record remains unchanged and the grok command fails, causing backtracking of the command chain.</p> 
<dl> 
 <dd>
   Note: The morphline configuration file is implemented using the HOCON format (Human Optimized Config Object Notation). HOCON is basically JSON slightly adjusted for the configuration file use case. HOCON syntax is defined at 
  <a class="externalLink" href="http://github.com/typesafehub/config/blob/master/HOCON.md">HOCON github page</a> and as such, multi-line strings are similar to Python or Scala, using triple quotes. If the three-character sequence 
  <tt>&quot;&quot;&quot;</tt> appears, then all Unicode characters until a closing 
  <tt>&quot;&quot;&quot;</tt> sequence are used unmodified to create a string value. 
 </dd> 
</dl> 
<p>In addition, the grok command supports the following parameters:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> dictionaryFiles </td> 
   <td> [] </td> 
   <td> A list of zero or more local files or directory trees from which to load dictionaries. </td> 
  </tr> 
  <tr class="a"> 
   <td> dictionaryString </td> 
   <td> null </td> 
   <td> An optional inline string from which to load a dictionary. </td> 
  </tr> 
  <tr class="b"> 
   <td> extract </td> 
   <td> true </td> 
   <td> Can be &quot;false&quot;, &quot;true&quot;, or &quot;inplace&quot;. Add the content of named capturing groups to the input record (&quot;inplace&quot;), to a copy of the input record (&quot;true&quot;), or to no record (&quot;false&quot;). </td> 
  </tr> 
  <tr class="a"> 
   <td> numRequiredMatches </td> 
   <td> atLeastOnce </td> 
   <td> Indicates the minimum and maximum number of field values that must match a given grok expression for each input field name. Can be &quot;atLeastOnce&quot; (default), &quot;once&quot;, or &quot;all&quot;. </td> 
  </tr> 
  <tr class="b"> 
   <td> findSubstrings </td> 
   <td> false </td> 
   <td> Indicates whether the grok expression must match the entire input field value or merely a substring within. </td> 
  </tr> 
  <tr class="a"> 
   <td> addEmptyStrings </td> 
   <td> false </td> 
   <td> Indicates whether zero length strings stemming from empty (but matching) capturing groups shall be added to the output record. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre># Index syslog formatted files
#
# Example input line:
#
# &lt;164&gt;Feb  4 10:46:14 syslog sshd[607]: listening on 0.0.0.0 port 22.
#
# Expected output record fields:
#
# syslog_pri:164
# syslog_timestamp:Feb  4 10:46:14
# syslog_hostname:syslog
# syslog_program:sshd
# syslog_pid:607
# syslog_message:listening on 0.0.0.0 port 22.
#
grok {
  dictionaryFiles : [cdk-morphlines-core/src/test/resources/grok-dictionaries]
  expressions : {
    message : &quot;&quot;&quot;&lt;%{POSINT:syslog_pri}&gt;%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}&quot;&quot;&quot;

    #message2 : &quot;(?&lt;queue_field&gt;.*)&quot;
    #message4 : &quot;%{NUMBER:queue_field}&quot;
  }
}
</pre> 
</div> 
<p>More example usage:</p> 
<div class="source"> 
 <pre># Split a line on one or more whitespace into substrings,
# and add the substrings to the &quot;columns&quot; output field.
#
# Example input line with tabs:
#
# &quot;hello\t\tworld\tfoo&quot;
#
# Expected output record fields:
#
# columns:hello
# columns:world
# columns:foo
#
grok {
  expressions : {
    message : &quot;&quot;&quot;(?&lt;columns&gt;.+?)(\s+|\z)&quot;&quot;&quot;
  }
  findSubstrings : true
}
</pre> 
</div> 
<p>Even more example usage:</p> 
<div class="source"> 
 <pre># Index a custom variant of syslog files where subfacility is optional
#
# Example input line:
#
# &lt;179&gt;Jun 10 04:42:51 www.foo.com Jun 10 2013 04:42:51 : %myproduct-3-mysubfacility-123456: Health probe failed
#
# Expected output record fields:
#
# my_message_code:%myproduct-3-mysubfacility-123456
# my_product:myproduct
# my_level:3
# my_subfacility:mysubfacility
# my_message_id:123456
# syslog_message:%myproduct-3-mysubfacility-123456: Health probe failed
#
grok {
  dictionaryFiles : [cdk-morphlines-core/src/test/resources/grok-dictionaries]
  dictionaryString : &quot;&quot;&quot;
    MY_CUSTOM_TIMESTAMP %{MONTH} %{MONTHDAY} %{YEAR} %{TIME}
  &quot;&quot;&quot;

  expressions : {
    message : &quot;&quot;&quot;&lt;%{POSINT}&gt;%{SYSLOGTIMESTAMP} %{SYSLOGHOST} %{MY_CUSTOM_TIMESTAMP} : (?&lt;syslog_message&gt;(?&lt;my_message_code&gt;%%{\w+:my_product}-%{\w+:my_level}(-%{\w+:my_subfacility})?-%{\w+:my_message_id}): %{GREEDYDATA})&quot;&quot;&quot;
  }
}
</pre> 
</div> 
<dl> 
 <dd>
   Note: An easy way to test grok out is to use the 
  <a class="externalLink" href="http://grokdebug.herokuapp.com/">online grok debugger</a> from the logstash project. There is also a corresponding 
  <a class="externalLink" href="http://www.youtube.com/watch?v=YIKm6WUgFTY">YouTube video</a>. 
 </dd> 
</dl> 
<div class="section"> 
 <h3 id="if">if</h3> 
</div> 
<p>The <tt>if</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/IfThenElseBuilder.java">source code</a>) implements if-then-else conditional control flow. It consists of a chain of zero or more conditions commands, as well as an optional chain of zero or or more commands that are processed if all conditions succeed (&quot;<tt>then</tt> commands&quot;), as well as an optional chain of zero or more commands that are processed if one of the conditions fails (&quot;<tt>else</tt> commands&quot;).</p> 
<p>If one of the commands in the <tt>then</tt> chain or <tt>else</tt> chain fails, then the entire <tt>if</tt> command fails and any remaining commands in the <tt>then</tt> or <tt>else</tt> branch are skipped.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> conditions </td> 
   <td> [] </td> 
   <td> A list of zero or more commands. </td> 
  </tr> 
  <tr class="a"> 
   <td> then </td> 
   <td> [] </td> 
   <td> A list of zero or more commands. </td> 
  </tr> 
  <tr class="b"> 
   <td> else </td> 
   <td> [] </td> 
   <td> A list of zero or more commands. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>if {
  conditions : [
    { contains { _attachment_mimetype : [avro/binary] } }
  ]
  then : [
    { logInfo { format : &quot;processing then...&quot; } }
  ]
  else : [
    { logInfo { format : &quot;processing else...&quot; } }
  ]
}
</pre> 
</div> 
<p>More example usage - Ignore all records that don't have an <tt>id</tt> field:</p> 
<div class="source"> 
 <pre>if {
  conditions : [
    { equals { id : [] } }
  ]
  then : [
    { logTrace { format : &quot;Ignoring record because it has no id: {}&quot;, args : [&quot;@{}&quot;] } }
    { dropRecord {} }    
  ]
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="java">java</h3> 
</div> 
<p>The <tt>java</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/JavaBuilder.java">source code</a>) provides scripting support for Java. The command compiles and executes the given Java code block, wrapped into a Java method with a Boolean return type and several parameters, along with a Java class definition that contains the given import statements.</p> 
<p>The following enclosing method declaration is used to pass parameters to the Java code block:</p> 
<div class="source"> 
 <pre>public static boolean evaluate(Record record, Config config, Command parent, Command child, MorphlineContext context, Logger logger) {
  // your custom java code block goes here...
}
</pre> 
</div> 
<p>Compilation is done in main memory, meaning without writing to the filesystem.</p> 
<p>The result is an object that can be executed (and reused) any number of times. This is a high performance implementation, using an optimized variant of <a class="externalLink" href="https://scripting.dev.java.net/">https://scripting.dev.java.net/</a>&quot; (JSR 223 Java Scripting). Calling <tt>eval()</tt> just means calling <tt>Method.invoke()</tt>, and, as such, has the same minimal runtime cost. As a result of the low cost, this command can be called on the order of 100 million times per second per CPU core on industry standard hardware.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> imports </td> 
   <td> A default list sufficient for typical usage. </td> 
   <td> A string containing zero or more Java import declarations. </td> 
  </tr> 
  <tr class="a"> 
   <td> code </td> 
   <td> [] </td> 
   <td> A Java code block as defined in the Java language specification. Must return a Boolean value. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>java {
  imports : &quot;import java.util.*;&quot;
  code: &quot;&quot;&quot;
    // Update some custom metrics - see http://metrics.codahale.com/getting-started/
    context.getMetricRegistry().counter(&quot;myMetrics.myCounter&quot;).inc(1);
    context.getMetricRegistry().meter(&quot;myMetrics.myMeter&quot;).mark(1);
    context.getMetricRegistry().histogram(&quot;myMetrics.myHistogram&quot;).update(100);
    com.codahale.metrics.Timer.Context timerContext = context.getMetricRegistry().timer(&quot;myMetrics.myTimer&quot;).time();
                
    // manipulate the contents of a record field
    List tags = record.get(&quot;tags&quot;);
    if (!tags.contains(&quot;hello&quot;)) {
      return false;
    }
    tags.add(&quot;world&quot;);
    
    logger.debug(&quot;tags: {} for record: {}&quot;, tags, record); // log to SLF4J
    timerContext.stop(); // measure how much time the code block took
    return child.process(record); // pass record to next command in chain
        &quot;&quot;&quot;
}
</pre> 
</div> 
<p><a id="logTrace"></a> <br /> <br /></p> 
<div class="section"> 
 <h3 id="logTrace_logDebug_logInfo_logWarn_logError">logTrace, logDebug, logInfo, logWarn, logError</h3> 
</div> 
<p>These commands log a message at the given log level to <a class="externalLink" href="http://www.slf4j.org">SLF4J</a>. The command can fetch the values of a record field using a <i>field expression</i>, which is a string of the form @{fieldname}. The special field expression @{} can be used to log the entire record.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre># log the entire record at DEBUG level to SLF4J
logDebug { format : &quot;my record: {}&quot;, args : [&quot;@{}&quot;] }
</pre> 
</div> 
<p>More example usage:</p> 
<div class="source"> 
 <pre># log the timestamp field and the entire record at INFO level to SLF4J
logInfo {
  format : &quot;timestamp: {}, record: {}&quot;
  args : [&quot;@{timestamp}&quot;, &quot;@{}&quot;]
}
</pre> 
</div> 
<p>To automatically print diagnostic information such as the content of records as they pass through the morphline commands, consider enabling TRACE log level, for example by adding the following line to your log4j.properties file:</p> 
<div class="source"> 
 <pre>log4j.logger.com.cloudera.cdk.morphline=TRACE
</pre> 
</div> 
<div class="section"> 
 <h3 id="not">not</h3> 
</div> 
<p>The <tt>not</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/NotBuilder.java">source code</a>) inverts the boolean return value of a nested command. The command consists of one nested command, the Boolean return value of which is inverted.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>if {
  conditions : [
    {
      not {
        grok {
          ... some grok expressions go here
        }
      }
    }
  ]
  then : [
    { logDebug { format : &quot;found no grok match: {}&quot;, args : [&quot;@{}&quot;] } }
    { dropRecord {} }
  ]
  else : [
    { logDebug { format : &quot;found grok match: {}&quot;, args : [&quot;@{}&quot;] } }
  ]
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="pipe">pipe</h3> 
</div> 
<p>The <tt>pipe</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/Pipe.java">source code</a>) pipes a record through a chain of commands. The <tt>pipe</tt> command has an identifier and contains a chain of zero or more commands, through which records get piped. A command transforms the record into zero or more records. The output records of a command are passed to the next command in the chain. A command has a Boolean return code, indicating success or failure. If any command in the pipe fails (meaning that it returns <tt>false</tt>), the whole pipe fails (meaning that it returns <tt>false</tt>), which causes backtracking of the command chain.</p> 
<p>Because a pipe is itself a command, a pipe can contain arbitrarily nested pipes. A <i>morphline</i> is a pipe. &quot;Morphline&quot; is simply another name for the pipe at the root of the command tree.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> id </td> 
   <td> n/a </td> 
   <td> An identifier for this pipe. </td> 
  </tr> 
  <tr class="a"> 
   <td> importCommands </td> 
   <td> [] </td> 
   <td> A list of zero or more import specifications, each of which makes all morphline commands that match the specification visible to the morphline. A specification can import all commands in an entire Java package tree (specification ends with &quot;.**&quot;), all commands in a Java package (specification ends with &quot;.*&quot;), or the command of a specific fully qualified Java class (all other specifications). Other commands present on the Java classpath are not visible to this morphline. </td> 
  </tr> 
  <tr class="b"> 
   <td> commands </td> 
   <td> [] </td> 
   <td> A list of zero or more commands. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage demonstrating a pipe with two commands, namely <tt>addValues</tt> and <tt>logDebug</tt>:</p> 
<div class="source"> 
 <pre>pipe {
  id : my_pipe

  # Import all commands in these java packages, subpackages and classes.
  # Other commands on the Java classpath are not visible to this morphline.
  importCommands : [
    &quot;com.cloudera.**&quot;,   # package and all subpackages
    &quot;org.apache.solr.**&quot;, # package and all subpackages
    &quot;com.mycompany.mypackage.*&quot;, # package only
    &quot;com.cloudera.cdk.morphline.stdlib.GrokBuilder&quot; # fully qualified class
  ]

  commands : [
    { addValues { foo : bar }}
    { logDebug { format : &quot;output record: {}&quot;, args : [&quot;@{}&quot;] } }
  ]
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="separateAttachments">separateAttachments</h3> 
</div> 
<p>The <tt>separateAttachments</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/SeparateAttachmentsBuilder.java">source code</a>) emits one output record for each attachment in the input record's list of attachments. The result is many records, each of which has at most one attachment.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>separateAttachments {}
</pre> 
</div> 
<div class="section"> 
 <h3 id="setValues">setValues</h3> 
</div> 
<p>The <tt>setValues</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/SetValuesBuilder.java">source code</a>) assigns a given list of values (or the contents of another field) to a given field. This command is the same as the <a href="#addValues">addValues</a> command, except that it first removes all values from the given output field, and then it adds new values.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>setValues {
  # assign values &quot;text/log&quot; and &quot;text/log2&quot; to source_type output field
  source_type : [text/log, text/log2]

  # assign the integer 123 to the pid field
  pid : [123]

  # remove the url field
  url : []

  # assign all values contained in the first_name field to the name field
  name : &quot;@{first_name}&quot;
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="split">split</h3> 
</div> 
<p>The <tt>split</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/SplitBuilder.java">source code</a>) divides strings into substrings, by recognizing a <i>separator</i> (a.k.a. &quot;delimiter&quot;) which can be expressed as a single character, literal string, regular expression, or <a href="#grok">grok</a> pattern. This class provides the functionality of Guava's <a class="externalLink" href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Splitter.html">Splitter</a> class as a morphline command, plus it also supports grok dictionaries and regexes in the same way as the <tt>grok</tt> command, except it doesn't support the grok extraction features.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> inputField </td> 
   <td> n/a </td> 
   <td> The name of the input field. </td> 
  </tr> 
  <tr class="a"> 
   <td> outputField </td> 
   <td> null </td> 
   <td> The name of the field to add output values to, i.e. a single string. Example: <tt>tokens</tt>. One of <tt>outputField</tt> or <tt>outputFields</tt> must be present, but not both. </td> 
  </tr> 
  <tr class="b"> 
   <td> outputFields </td> 
   <td> null </td> 
   <td> The names of the fields to add output values to, i.e. a list of strings. Example: [firstName, lastName, &quot;&quot;, age]. An empty string in a list indicates omit this column in the output. One of <tt>outputField</tt> or <tt>outputFields</tt> must be present, but not both. </td> 
  </tr> 
  <tr class="a"> 
   <td> separator </td> 
   <td> n/a </td> 
   <td> The delimiting string to search for. </td> 
  </tr> 
  <tr class="b"> 
   <td> isRegex </td> 
   <td> false </td> 
   <td> Whether or not to interpret the separator as a grok pattern (true) or string literal (false). </td> 
  </tr> 
  <tr class="a"> 
   <td> dictionaryFiles </td> 
   <td> [] </td> 
   <td> A list of zero or more local files or directory trees from which to load dictionaries. Only applicable if <tt>isRegex</tt> is <tt>true</tt>. See <a href="#grok">grok</a> command. </td> 
  </tr> 
  <tr class="b"> 
   <td> dictionaryString </td> 
   <td> null </td> 
   <td> An optional inline string from which to load a dictionary. Only applicable if <tt>isRegex</tt> is <tt>true</tt>. See <a href="#grok">grok</a> command. </td> 
  </tr> 
  <tr class="a"> 
   <td> trim </td> 
   <td> true </td> 
   <td> Whether or not to apply the <tt>String.trim()</tt> method on the output values to be added. </td> 
  </tr> 
  <tr class="b"> 
   <td> addEmptyStrings </td> 
   <td> false </td> 
   <td> Whether or not to add zero length strings to the output field. </td> 
  </tr> 
  <tr class="a"> 
   <td> limit </td> 
   <td> -1 </td> 
   <td> The maximum number of items to add to the output field per input field value. -1 indicates unlimited. </td> 
  </tr> 
 </tbody> 
</table> 
<div class="section"> 
 <h5 id="Example_usage_with_multiple_output_field_names_and_literal_string_as_separator:">Example usage with multiple output field names and literal string as separator:</h5> 
</div> 
<div class="source"> 
 <pre>split { 
  inputField : message
  outputFields : [first_name, last_name, &quot;&quot;, age]          
  separator : &quot;,&quot;        
  isRegex : false      
  #separator : &quot;&quot;&quot;\s*,\s*&quot;&quot;&quot;        
  #isRegex : true      
  addEmptyStrings : false
  trim : true          
}
</pre> 
</div> 
<p>Input record:</p> 
<div class="source"> 
 <pre>message:&quot;Nadja,Redwood,female,8&quot;
</pre> 
</div> 
<p>Expected output:</p> 
<div class="source"> 
 <pre>first_name:Nadja
last_name:Redwood
age:8
</pre> 
</div> 
<div class="section"> 
 <h5 id="More_example_usage_with_one_output_field_and_literal_string_as_separator:">More example usage with one output field and literal string as separator:</h5> 
</div> 
<div class="source"> 
 <pre>split { 
  inputField : message
  outputField : substrings          
  separator : &quot;,&quot;        
  isRegex : false      
  #separator : &quot;&quot;&quot;\s*,\s*&quot;&quot;&quot;        
  #isRegex : true      
  addEmptyStrings : false
  trim : true          
}
</pre> 
</div> 
<p>Input record:</p> 
<div class="source"> 
 <pre>message:&quot;_a ,_b_ ,c__&quot;
</pre> 
</div> 
<p>Expected output contains a &quot;substrings&quot; field with three values:</p> 
<div class="source"> 
 <pre>substrings:_a
substrings:_b_
substrings:c__
</pre> 
</div> 
<div class="section"> 
 <h5 id="More_example_usage_with_grok_pattern_or_normal_regex:">More example usage with grok pattern or normal regex:</h5> 
</div> 
<div class="source"> 
 <pre>split { 
  inputField : message
  outputField : substrings
  # dictionaryFiles : [cdk-morphlines-core/src/test/resources/grok-dictionaries] 
  dictionaryString : &quot;&quot;&quot;COMMA_SURROUNDED_BY_WHITESPACE \s*,\s*&quot;&quot;&quot;          
  separator : &quot;&quot;&quot;%{COMMA_SURROUNDED_BY_WHITESPACE}&quot;&quot;&quot;        
  # separator : &quot;&quot;&quot;\s*,\s*&quot;&quot;&quot;        
  isRegex : true      
  addEmptyStrings : true
  trim : false          
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="splitKeyValue">splitKeyValue</h3> 
</div> 
<p>The <tt>splitKeyValue</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/SplitKeyValueBuilder.java">source code</a>) iterates over the items in a given record input field, interprets each item as a key-value pair where the key and value are separated by the given separator character, and adds the pair's value to the record field named after the pair's key. Typically, the input field items have been placed there by an upstream <a href="#split">split</a> command with a single output field.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> inputField </td> 
   <td> n/a </td> 
   <td> The name of the input field. </td> 
  </tr> 
  <tr class="a"> 
   <td> outputFieldPrefix </td> 
   <td> &quot;&quot; </td> 
   <td> A string to be prepended to each output field name. </td> 
  </tr> 
  <tr class="b"> 
   <td> separator </td> 
   <td> &quot;=&quot; </td> 
   <td> The character separating the key from the value. </td> 
  </tr> 
  <tr class="a"> 
   <td> trim </td> 
   <td> true </td> 
   <td> Whether or not to apply the <tt>String.trim()</tt> method on the output keys and values to be added. </td> 
  </tr> 
  <tr class="b"> 
   <td> addEmptyStrings </td> 
   <td> false </td> 
   <td> Whether or not to add zero length strings to the output field. </td> 
  </tr> 
 </tbody> 
</table> 
<div class="section"> 
 <h5 id="Example_usage:">Example usage:</h5> 
</div> 
<div class="source"> 
 <pre>splitKeyValue { 
  inputField : params
  outputFieldPrefix : &quot;/&quot;
}
</pre> 
</div> 
<p>Input record:</p> 
<div class="source"> 
 <pre>params:foo=x
params: foo = y 
params:foo 
params:fragment=z
</pre> 
</div> 
<p>Expected output:</p> 
<div class="source"> 
 <pre>/foo:x
/foo:y
/fragment:z
</pre> 
</div> 
<div class="section"> 
 <h5 id="Example_usage_that_extracts_data_from_iptables_log_file:">Example usage that extracts data from iptables log file:</h5> 
</div> 
<div class="source"> 
 <pre># read each line in the file
{ 
  readLine {
    charset : UTF-8
  }
} 
                
# extract timestamp and key value pair string
{ 
  grok { 
    dictionaryFiles : [target/test-classes/grok-dictionaries/grok-patterns]
    expressions : { 
      message : &quot;&quot;&quot;%{SYSLOGTIMESTAMP:timestamp} %{GREEDYDATA:key_value_pairs_string}&quot;&quot;&quot;
    }
  }
}

# split key value pair string on blanks into an array of key value pairs
{ 
  split { 
    inputField : key_value_pairs_string
    outputField : key_value_array          
    separator : &quot; &quot;        
  }
}

# split each key value pair on '=' char and extract its value into record fields named after the key
{ 
  splitKeyValue { 
    inputField : key_value_array
    outputFieldPrefix : &quot;&quot;          
    separator : &quot;=&quot;        
    addEmptyStrings : false
    trim : true          
  }
}

# remove temporary work fields
{ 
  setValues {
    key_value_pairs_string : []
    key_value_array : []
  }
}
</pre> 
</div> 
<p>Input file:</p> 
<div class="source"> 
 <pre>Feb  6 12:04:42 IN=eth1 OUT=eth0 SRC=1.2.3.4 DST=6.7.8.9 ACK DF WINDOW=0
</pre> 
</div> 
<p>Expected output record:</p> 
<div class="source"> 
 <pre>timestamp:Feb  6 12:04:42
IN:eth1
OUT:eth0
SRC:1.2.3.4
DST:6.7.8.9
WINDOW:0
</pre> 
</div> 
<div class="section"> 
 <h3 id="startReportingMetricsToCSV">startReportingMetricsToCSV</h3> 
</div> 
<p>The <tt>startReportingMetricsToCSV</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/StartReportingMetricsToCSVBuilder.java">source code</a>) starts periodically appending the metrics of all morphline commands to a set of CSV files. The CSV files are named after the metrics.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> outputDir </td> 
   <td> n/a </td> 
   <td> The relative or absolute path of the output directory on the local file system. The directory and it's parent directories will be created automatically if they don't yet exist. </td> 
  </tr> 
  <tr class="a"> 
   <td> frequency </td> 
   <td> &quot;10 seconds&quot; </td> 
   <td> The amount of time between reports to the output file, given in <a class="externalLink" href="https://github.com/typesafehub/config/blob/master/HOCON.md#duration-format">HOCON duration format</a>. </td> 
  </tr> 
  <tr class="b"> 
   <td> locale </td> 
   <td> JVM default Locale </td> 
   <td> Format numbers for the given Java Locale. Example: &quot;en_US&quot; </td> 
  </tr> 
  <tr class="a"> 
   <td> defaultDurationUnit </td> 
   <td> milliseconds </td> 
   <td> Report output durations in the given time unit. One of <tt>nanoseconds</tt>, <tt>microseconds</tt>, <tt>milliseconds</tt>, <tt>seconds</tt>, <tt>minutes</tt>, <tt>hours</tt>, <tt>days</tt>. </td> 
  </tr> 
  <tr class="b"> 
   <td> defaultRateUnit </td> 
   <td> seconds </td> 
   <td> Report output rates in the given time unit. One of <tt>nanoseconds</tt>, <tt>microseconds</tt>, <tt>milliseconds</tt>, <tt>seconds</tt>, <tt>minutes</tt>, <tt>hours</tt>, <tt>days</tt>. Example output: events/second </td> 
  </tr> 
  <tr class="a"> 
   <td> metricFilter </td> 
   <td> null </td> 
   <td> Only report metrics which match the given (optional) filter, as described in more detail below. If the filter is absent all metrics match. </td> 
  </tr> 
 </tbody> 
</table> 
<div class="section"> 
 <h5 id="metricFilter">metricFilter</h5> 
</div> 
<p>A metricFilter uses pattern matching with include/exclude specifications to determine if a given metric shall be reported to the output destination.</p> 
<p>A metric consists of a metric name and a metric class name. A metric matches the filter if the metric matches at least one include specification, but matches none of the exclude specifications. An include/exclude specification consists of zero or more expression pairs. Each expression pair consists of an expression for the metric name, as well as an expression for the metric's class name. Each expression can be a <a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html">regex pattern</a> (e.g. &quot;regex:foo.*&quot;) or <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/shaded/org/apache/hadoop/fs/GlobPattern.java">POSIX glob pattern</a> (e.g. &quot;glob:foo*&quot;) or literal string (e.g. &quot;literal:foo&quot;) or &quot;*&quot; which is equivalent to &quot;glob:*&quot;. Each expression pair defines one expression for the metric name and another expression for the metric class name.</p> 
<p>If the include specification is absent it defaults to MATCH ALL. If the exclude specification is absent it defaults to MATCH NONE.</p> 
<div class="section"> 
 <h5 id="Example_startReportingMetricsToCSV_usage">Example startReportingMetricsToCSV usage</h5> 
</div> 
<div class="source"> 
 <pre>startReportingMetricsToCSV {
  outputDir : &quot;mytest/metricsLogs&quot;
  frequency : &quot;10 seconds&quot;
  locale : en_US
}
</pre> 
</div> 
<div class="section"> 
 <h5 id="More_example_startReportingMetricsToCSV_usage">More example startReportingMetricsToCSV usage</h5> 
</div> 
<div class="source"> 
 <pre>startReportingMetricsToCSV {
  outputDir : &quot;mytest/metricsLogs&quot;
  frequency : &quot;10 seconds&quot;
  locale : en_US
  defaultDurationUnit : milliseconds
  defaultRateUnit : seconds
  metricFilter : {
    includes : { # if absent defaults to match all
      &quot;literal:foo&quot; : &quot;glob:foo*&quot;
      &quot;regex:.*&quot; : &quot;glob:*&quot;
    }
    excludes : { # if absent defaults to match none
      &quot;literal:foo.bar&quot; : &quot;*&quot;
    }
  }          
}
</pre> 
</div> 
<div class="section"> 
 <h5 id="Example_output_log_file">Example output log file</h5> 
</div> 
<div class="source"> 
 <pre>t,count,mean_rate,m1_rate,m5_rate,m15_rate,rate_unit
1380054913,2,409.752100,0.000000,0.000000,0.000000,events/second
1380055913,2,258.131131,0.000000,0.000000,0.000000,events/second
</pre> 
</div> 
<div class="section"> 
 <h3 id="startReportingMetricsToJMX">startReportingMetricsToJMX</h3> 
</div> 
<p>The <tt>startReportingMetricsToJMX</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/StartReportingMetricsToJMXBuilder.java">source code</a>) starts publishing the metrics of all morphline commands to <a class="externalLink" href="http://en.wikipedia.org/wiki/Java_Management_Extensions">JMX</a>.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> domain </td> 
   <td> metrics </td> 
   <td> The name of the JMX domain (aka category) to publish to. </td> 
  </tr> 
  <tr class="a"> 
   <td> durationUnits </td> 
   <td> null </td> 
   <td> Report output durations of the given metrics in the given time units. This optional parameter is a JSON object where the key is the metric name and the value is a time unit. The time unit can be one of <tt>nanoseconds</tt>, <tt>microseconds</tt>, <tt>milliseconds</tt>, <tt>seconds</tt>, <tt>minutes</tt>, <tt>hours</tt>, <tt>days</tt>. </td> 
  </tr> 
  <tr class="b"> 
   <td> defaultDurationUnit </td> 
   <td> milliseconds </td> 
   <td> Report all other output durations in the given time unit. One of <tt>nanoseconds</tt>, <tt>microseconds</tt>, <tt>milliseconds</tt>, <tt>seconds</tt>, <tt>minutes</tt>, <tt>hours</tt>, <tt>days</tt>. </td> 
  </tr> 
  <tr class="a"> 
   <td> rateUnits </td> 
   <td> null </td> 
   <td> Report output rates of the given metrics in the given time units. This optional parameter is a JSON object where the key is the metric name and the value is a time unit. The time unit can be one of <tt>nanoseconds</tt>, <tt>microseconds</tt>, <tt>milliseconds</tt>, <tt>seconds</tt>, <tt>minutes</tt>, <tt>hours</tt>, <tt>days</tt>. </td> 
  </tr> 
  <tr class="b"> 
   <td> defaultRateUnit </td> 
   <td> seconds </td> 
   <td> Report all other output rates in the given time unit. One of <tt>nanoseconds</tt>, <tt>microseconds</tt>, <tt>milliseconds</tt>, <tt>seconds</tt>, <tt>minutes</tt>, <tt>hours</tt>, <tt>days</tt>. Example output: events/second </td> 
  </tr> 
  <tr class="a"> 
   <td> metricFilter </td> 
   <td> null </td> 
   <td> Only report metrics which match the given (optional) filter, as described in more detail <a href="#metricFilter">above</a>. If the filter is absent all metrics match. </td> 
  </tr> 
 </tbody> 
</table> 
<div class="section"> 
 <h5 id="Example_startReportingMetricsToJMX_usage">Example startReportingMetricsToJMX usage</h5> 
</div> 
<div class="source"> 
 <pre>startReportingMetricsToJMX {
  domain : myMetrics
}
</pre> 
</div> 
<div class="section"> 
 <h5 id="More_example_startReportingMetricsToJMX_usage">More example startReportingMetricsToJMX usage</h5> 
</div> 
<div class="source"> 
 <pre>startReportingMetricsToJMX {
  domain : myMetrics
  durationUnits : {
    myMetrics.myTimer : minutes
  }
  defaultDurationUnit : milliseconds
  rateUnits : {
    myMetrics.myTimer : milliseconds
    morphline.logDebug.numProcessCalls : milliseconds
  }
  defaultRateUnit : seconds
  metricFilter : {
    includes : { # if absent defaults to match all
      &quot;literal:foo&quot; : &quot;glob:foo*&quot;
      &quot;regex:.*&quot; : &quot;glob:*&quot;
    }
    excludes : { # if absent defaults to match none
      &quot;literal:foo.bar&quot; : &quot;*&quot;
    }
  }          
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="startReportingMetricsToSLF4J">startReportingMetricsToSLF4J</h3> 
</div> 
<p>The <tt>startReportingMetricsToSLF4J</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/StartReportingMetricsToSLF4JBuilder.java">source code</a>) starts periodically logging the metrics of all morphline commands to <a class="externalLink" href="http://www.slf4j.org">SLF4J</a>.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> logger </td> 
   <td> metrics </td> 
   <td> The name of the SLF4J logger to write to. </td> 
  </tr> 
  <tr class="a"> 
   <td> marker </td> 
   <td> null </td> 
   <td> The optional name of the SLF4J marker object to associate with each logging request. </td> 
  </tr> 
  <tr class="b"> 
   <td> frequency </td> 
   <td> &quot;10 seconds&quot; </td> 
   <td> The amount of time between reports to the output file, given in <a class="externalLink" href="https://github.com/typesafehub/config/blob/master/HOCON.md#duration-format">HOCON duration format</a>. </td> 
  </tr> 
  <tr class="a"> 
   <td> defaultDurationUnit </td> 
   <td> milliseconds </td> 
   <td> Report output durations in the given time unit. One of <tt>nanoseconds</tt>, <tt>microseconds</tt>, <tt>milliseconds</tt>, <tt>seconds</tt>, <tt>minutes</tt>, <tt>hours</tt>, <tt>days</tt>. </td> 
  </tr> 
  <tr class="b"> 
   <td> defaultRateUnit </td> 
   <td> seconds </td> 
   <td> Report output rates in the given time unit. One of <tt>nanoseconds</tt>, <tt>microseconds</tt>, <tt>milliseconds</tt>, <tt>seconds</tt>, <tt>minutes</tt>, <tt>hours</tt>, <tt>days</tt>. Example output: events/second </td> 
  </tr> 
  <tr class="a"> 
   <td> metricFilter </td> 
   <td> null </td> 
   <td> Only report metrics which match the given (optional) filter, as described in more detail <a href="#metricFilter">above</a>. If the filter is absent all metrics match. </td> 
  </tr> 
 </tbody> 
</table> 
<div class="section"> 
 <h5 id="Example_startReportingMetricsToSLF4J_usage">Example startReportingMetricsToSLF4J usage</h5> 
</div> 
<div class="source"> 
 <pre>startReportingMetricsToSLF4J {
  logger : &quot;com.cloudera.cdk.morphline.domain1&quot;
  frequency : &quot;10 seconds&quot;
}
</pre> 
</div> 
<div class="section"> 
 <h5 id="More_example_startReportingMetricsToSLF4J_usage">More example startReportingMetricsToSLF4J usage</h5> 
</div> 
<div class="source"> 
 <pre>startReportingMetricsToSLF4J {
  logger : &quot;com.cloudera.cdk.morphline.domain1&quot;
  frequency : &quot;10 seconds&quot;
  defaultDurationUnit : milliseconds
  defaultRateUnit : seconds
  metricFilter : {
    includes : { # if absent defaults to match all
      &quot;literal:foo&quot; : &quot;glob:foo*&quot;
      &quot;regex:.*&quot; : &quot;glob:*&quot;
    }
    excludes : { # if absent defaults to match none
      &quot;literal:foo.bar&quot; : &quot;*&quot;
    }
  }          
}
</pre> 
</div> 
<div class="section"> 
 <h5 id="Example_output_log_line">Example output log line</h5> 
</div> 
<div class="source"> 
 <pre>457  [metrics-logger-reporter-thread-1] INFO  com.cloudera.cdk.morphline.domain1  - type=METER, name=morphline.logDebug.numProcessCalls, count=2, mean_rate=144.3001443001443, m1=0.0, m5=0.0, m15=0.0, rate_unit=events/second
</pre> 
</div> 
<div class="section"> 
 <h3 id="toByteArray">toByteArray</h3> 
</div> 
<p>The <tt>toByteArray</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ToByteArrayBuilder.java">source code</a>) converts the Java objects in a given field via <tt>Object.toString()</tt> to their string representation, and then via <tt>String.getBytes(Charset)</tt> to their byte array representation. If the input Java objects are already byte arrays the command does nothing.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> field </td> 
   <td> n/a </td> 
   <td> The name of the field to convert. </td> 
  </tr> 
  <tr class="a"> 
   <td> charset </td> 
   <td> UTF-8 </td> 
   <td> The character encoding to use. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>toByteArray { field : _attachment_body }
</pre> 
</div> 
<div class="section"> 
 <h3 id="toString">toString</h3> 
</div> 
<p>The <tt>toString</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ToStringBuilder.java">source code</a>) converts the Java objects in a given field using the <tt>Object.toString()</tt> method to their string representation, and optionally also applies the <tt>String.trim()</tt> method to remove leading and trailing whitespace.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> field </td> 
   <td> n/a </td> 
   <td> The name of the field to convert. </td> 
  </tr> 
  <tr class="a"> 
   <td> trim </td> 
   <td> false </td> 
   <td> Whether or not to apply the <tt>String.trim()</tt> method. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>toString { field : source_type }
</pre> 
</div> 
<div class="section"> 
 <h3 id="translate">translate</h3> 
</div> 
<p>The <tt>translate</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/TranslateBuilder.java">source code</a>) examines each value in a given field and replaces it with the replacement value defined in a given dictionary aka lookup hash table.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> field </td> 
   <td> n/a </td> 
   <td> The name of the field to modify. </td> 
  </tr> 
  <tr class="a"> 
   <td> dictionary </td> 
   <td> n/a </td> 
   <td> The lookup hash table to use for finding matches and replacement values </td> 
  </tr> 
  <tr class="b"> 
   <td> fallback </td> 
   <td> null </td> 
   <td> The fallback value to use as replacement if no match is found. If no fallback is defined and no match is found then the command fails. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage to translate <a class="externalLink" href="http://en.wikipedia.org/wiki/Syslog#Severity_levels">Syslog severity level</a> numeric codes to string labels:</p> 
<div class="source"> 
 <pre>translate {
  field : level
  dictionary : {
     0 : Emergency
     1 : Alert
     2 : Critical
     3 : Error
     4 : Warning
     5 : Notice
     6 : Informational
     7 : Debug
  }
  fallback : Unknown # if no fallback is defined and no match is found then the command fails
}
</pre> 
</div> 
<p>Input: <tt>level:0</tt></p> 
<p>Expected output: <tt>level:Emergency</tt></p> 
<p>Input: <tt>level:999</tt></p> 
<p>Expected output: <tt>level:Unknown</tt></p> 
<div class="section"> 
 <h3 id="tryRules">tryRules</h3> 
</div> 
<p>The <tt>tryRules</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/TryRulesBuilder.java">source code</a>) is a simple rule engine for handling a list of heterogeneous input data formats. The command consists of zero or more rules. A rule consists of zero or more commands.</p> 
<p>The rules of a <tt>tryRules</tt> command are processed in top-down order. If one of the commands in a rule fails, the <tt>tryRules</tt> command stops processing this rule, backtracks and tries the next rule, and so on, until a rule is found that runs all its commands to completion without failure (the rule <i>succeeds</i>). If a rule succeeds, the remaining rules of the current <tt>tryRules</tt> command are skipped. If no rule succeeds the record remains unchanged, but a warning may be issued or an exception may be thrown.</p> 
<p>Because a <tt>tryRules</tt> command is itself a command, a <tt>tryRules</tt> command can contain arbitrarily nested <tt>tryRules</tt> commands. By the same logic, a <tt>pipe</tt> command can contain arbitrarily nested <tt>tryRules</tt> commands and a <tt>tryRules</tt> command can contain arbitrarily nested <tt>pipe</tt> commands. This helps to implement complex functionality for advanced usage.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> catchExceptions </td> 
   <td> false </td> 
   <td> Whether Java exceptions thrown by a rule shall be caught, with processing continuing with the next rule (<tt>true</tt>), or whether such exceptions shall not be caught and consequently propagate up the call chain (<tt>false</tt>). </td> 
  </tr> 
  <tr class="a"> 
   <td> throwExceptionIfAllRulesFailed </td> 
   <td> true </td> 
   <td> Whether to throw a Java exception if no rule succeeds. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>tryRules {
  catchExceptions : false
  throwExceptionIfAllRulesFailed : true
  rules : [
    # next rule of tryRules cmd:
    {
      commands : [
        { contains { _attachment_mimetype : [avro/binary] } }
        ... handle Avro data here
        { logDebug { format : &quot;output record: {}&quot;, args : [&quot;@{}&quot;] } }
      ]
    }

    # next rule of tryRules cmd:
    {
      commands : [
        { contains { _attachment_mimetype : [text/csv] } }
        ... handle CSV data here
        { logDebug { format : &quot;output record: {}&quot;, args : [&quot;@{}&quot;] } }
      ]
    }
    
    # if desired, the last rule can serve as a fallback mechanism 
    # for records that don't match any rule:
    {
      commands : [
        { logWarn { format : &quot;Ignoring record with unsupported input format: {}&quot;, args : [&quot;@{}&quot;] }
        { dropRecord {} }    
      ]
    }
  ]
}
</pre> 
</div> 
<div class="section"> 
 <h2 id="cdk-morphlines-avro">cdk-morphlines-avro</h2> 
</div> 
<p>This maven module contains morphline commands for reading, extracting, and transforming Avro files and Avro objects.</p> 
<div class="section"> 
 <h3 id="readAvroContainer">readAvroContainer</h3> 
</div> 
<p>The <tt>readAvroContainer</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-avro/src/main/java/com/cloudera/cdk/morphline/avro/ReadAvroContainerBuilder.java">source code</a>) parses an InputStream or byte array that contains Apache Avro binary container file data. For each Avro datum, the command emits a morphline record containing the datum as an attachment in the field _attachment_body.</p> 
<p>The Avro schema that was used to write the Avro data is retrieved from the Avro container. Optionally, the Avro schema that shall be used for reading can be supplied with a configuration option; otherwise it is assumed to be the same as the writer schema.</p> 
<p>Note: Avro uses <a class="externalLink" href="http://avro.apache.org/docs/current/spec.html#Schema+Resolution">Schema Resolution</a> if the two schemas are different, e.g. if the reader schema is a subset of the writer schema for the purpose of efficient column projection.</p> 
<p>The input stream or byte array is read from the first attachment of the input record.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> supportedMimeTypes </td> 
   <td> null </td> 
   <td> Optionally, require the input record to match one of the MIME types in this list. </td> 
  </tr> 
  <tr class="a"> 
   <td> readerSchemaFile </td> 
   <td> null </td> 
   <td> An optional Avro schema file in JSON format on the local file system to use for reading. </td> 
  </tr> 
  <tr class="b"> 
   <td> readerSchemaString </td> 
   <td> null </td> 
   <td> An optional Avro schema in JSON format given inline to use for reading. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre># Parse Avro container file and emit a record for each avro object
readAvroContainer {
  # Optionally, require the input to match one of these MIME types:
  # supportedMimeTypes : [avro/binary]

  # Optionally, use this Avro schema in JSON format inline for reading:
  # readerSchemaString : &quot;&quot;&quot;&lt;json can go here&gt;&quot;&quot;&quot;

  # Optionally, use this Avro schema file in JSON format for reading:
  # readerSchemaFile : /path/to/syslog.avsc
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="readAvro">readAvro</h3> 
</div> 
<p>The <tt>readAvro</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-avro/src/main/java/com/cloudera/cdk/morphline/avro/ReadAvroBuilder.java">source code</a>) parses containerless Avro. This command is the same as the <a href="#readAvroContainer">readAvroContainer</a> command except that the Avro schema that was used to write the Avro data must be explicitly supplied to the <tt>readAvro</tt> command because it expects raw Avro data without an Avro container and hence without a built-in writer schema.</p> 
<p>Optionally, the Avro schema that shall be used for reading can be supplied with a configuration option; otherwise it is assumed to be the same as the writer schema.</p> 
<p>Note: Avro uses <a class="externalLink" href="http://avro.apache.org/docs/current/spec.html#Schema+Resolution">Schema Resolution</a> if the two schemas are different, e.g. if the reader schema is a subset of the writer schema for the purpose of efficient column projection.</p> 
<p>Note: For the <tt>readAvro</tt> command to work correctly, each Avro event must have been written with the same writer schema by the ingesting app. That is, you cannot parse two Avro events with two different writer schemas A and B within the same <tt>readAvro</tt> command. The <a href="#readAvroContainer">readAvroContainer</a> command doesn't have that limitation, of course, because the writer schema comes embedded inside each Avro container, per the standard Avro container specification.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> supportedMimeTypes </td> 
   <td> null </td> 
   <td> Optionally, require the input record to match one of the MIME types in this list. </td> 
  </tr> 
  <tr class="a"> 
   <td> readerSchemaFile </td> 
   <td> null </td> 
   <td> An optional Avro schema file in JSON format on the local file system to use for reading. </td> 
  </tr> 
  <tr class="b"> 
   <td> readerSchemaString </td> 
   <td> null </td> 
   <td> An optional Avro schema in JSON format given inline to use for reading. </td> 
  </tr> 
  <tr class="a"> 
   <td> writerSchemaFile </td> 
   <td> null </td> 
   <td> The Avro schema file in JSON format that was used to write the Avro data. </td> 
  </tr> 
  <tr class="b"> 
   <td> writerSchemaString </td> 
   <td> null </td> 
   <td> The Avro schema file in JSON format that was used to write the Avro data, given inline. </td> 
  </tr> 
  <tr class="a"> 
   <td> isJson </td> 
   <td> false </td> 
   <td> Whether the Avro input data is encoded as JSON or binary. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre># Parse Avro and emit a record for each avro object
readAvro {
  # supportedMimeTypes : [avro/binary]
  # readerSchemaString : &quot;&quot;&quot;&lt;json can go here&gt;&quot;&quot;&quot;
  # readerSchemaFile : test-documents/sample-statuses-20120906-141433-subschema.avsc
  # writerSchemaString : &quot;&quot;&quot;&lt;json can go here&gt;&quot;&quot;&quot;
  writerSchemaFile : test-documents/sample-statuses-20120906-141433.avsc
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="extractAvroTree">extractAvroTree</h3> 
</div> 
<p>The <tt>extractAvroTree</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-avro/src/main/java/com/cloudera/cdk/morphline/avro/ExtractAvroTreeBuilder.java">source code</a>) converts an attached Avro datum to a morphline record by recursively walking the Avro tree and extracting all data into a single morphline record, with fields named by their path in the Avro tree.</p> 
<p>The Avro input object is expected to be contained in the field _attachment_body, and typically placed there by an upstream <a href="#readAvroContainer">readAvroContainer</a> or <a href="#readAvro">readAvro</a> command.</p> 
<p>This kind of mapping is useful for simple Avro schemas, but for more complex schemas, this approach may be overly simplistic and expensive.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> outputFieldPrefix </td> 
   <td> &quot;&quot; </td> 
   <td> A string to be prepended to each output field name. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>extractAvroTree {
  outputFieldPrefix : &quot;&quot;
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="extractAvroPaths">extractAvroPaths</h3> 
</div> 
<p>The <tt>extractAvroPaths</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-avro/src/main/java/com/cloudera/cdk/morphline/avro/ExtractAvroPathsBuilder.java">source code</a>) extracts specific values from an Avro object, akin to a simple form of XPath. The command uses zero or more Avro path expressions to extract values from an Avro object.</p> 
<p>The Avro input object is expected to be contained in the field _attachment_body, and typically placed there by an upstream <a href="#readAvroContainer">readAvroContainer</a> or <a href="#readAvro">readAvro</a> command.</p> 
<p>Each path expression consists of a record output field name (on the left side of the colon ':') as well as zero or more path steps (on the right hand side), each path step separated by a '/' slash, akin to a simple form of XPath. Avro arrays are traversed with the '[]' notation.</p> 
<p>The result of a path expression is a list of objects, each of which is added to the given record output field.</p> 
<p>The path language supports all Avro concepts, including such concepts as nested structures, records, arrays, maps, and unions. The path language supports a flatten option that collects the primitives in a subtree into a flat output list.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> flatten </td> 
   <td> true </td> 
   <td> Whether to collect the primitives in a subtree into a flat output list. </td> 
  </tr> 
  <tr class="a"> 
   <td> paths </td> 
   <td> [] </td> 
   <td> Zero or more Avro path expressions. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>extractAvroPaths {
  flatten : true
  paths : {
    my_price : /price

    my_docId : /docId
    my_links : /links
    my_links_backward : &quot;/links/backward&quot;
    my_links_forward : &quot;/links/forward&quot;
    my_name_language_code : &quot;/name[]/language[]/code&quot;
    my_name_language_country : &quot;/name[]/language[]/country&quot;
    my_name : /name

    /mymapField/foo/label : /mapField/foo/label/
  }
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="toAvro">toAvro</h3> 
</div> 
<p>The <tt>toAvro</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-avro/src/main/java/com/cloudera/cdk/morphline/avro/ToAvroBuilder.java">source code</a>) converts a morphline record to an Avro record of Java class <tt>org.apache.avro.generic.IndexedRecord</tt>.</p> 
<p>The conversion supports all Avro concepts, including such concepts as nested structures, records, arrays, maps, and unions.</p> 
<p>The Avro output record object is added to the morphline field _attachment_body.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> schemaFile </td> 
   <td> null </td> 
   <td> An optional Avro schema file in JSON format on the local file system to use for writing. </td> 
  </tr> 
  <tr class="a"> 
   <td> schemaString </td> 
   <td> null </td> 
   <td> An optional Avro schema in JSON format given inline to use for writing. </td> 
  </tr> 
  <tr class="b"> 
   <td> schemaField </td> 
   <td> null </td> 
   <td> An optional <tt>org.apache.avro.Schema</tt> object fetched from the given record input field. One of <tt>schemaFile</tt> or <tt>schemaString</tt> or <tt>schemaField</tt> must be present, but not more than one. </td> 
  </tr> 
  <tr class="a"> 
   <td> mappings </td> 
   <td> [] </td> 
   <td> An optional JSON object containing zero or more mappings from morphline record field names to Avro record field names. Each mapping consists of an Avro output field name (on the left side of the colon ':') as well as a Morphline field name (on the right hand side). Example mapping: avroPrice : morphlinePrice. Any such mappings are optional - by default data is extracted from the morphline fields that carry the same name as the Avro fields defined in the Avro schema. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>toAvro {
  #schemaFile : /path/to/interop.avsc 
  #schemaField : _dataset_descriptor_schema 
  schemaString : &quot;&quot;&quot;
    {
      &quot;type&quot; : &quot;record&quot;,
      &quot;name&quot; : &quot;Rating&quot;,
      &quot;fields&quot; : [ 
        {
          &quot;name&quot; : &quot;userId&quot;,
          &quot;type&quot; : &quot;int&quot;
        }, 
        {
          &quot;name&quot; : &quot;rating&quot;,
          &quot;type&quot; : [&quot;int&quot;,&quot;null&quot;]
        }, 
        {
          &quot;name&quot; : &quot;reviews&quot;,
          &quot;type&quot; : {&quot;type&quot;: &quot;array&quot;, &quot;items&quot;: &quot;string&quot;}
        }, 
        {
          &quot;name&quot; : &quot;history&quot;,
          &quot;type&quot; : [&quot;null&quot;, {&quot;type&quot;: &quot;map&quot;, &quot;values&quot;:     
                              {&quot;type&quot;: &quot;record&quot;, &quot;name&quot;: &quot;Foo&quot;,
                                   &quot;fields&quot;: [{&quot;name&quot;: &quot;timestamp&quot;, &quot;type&quot;: &quot;long&quot;}]}}]
        } 
      ]
    }
  &quot;&quot;&quot;
  mappings : { 
    userId : morphlineUserId
  }          
} 
</pre> 
</div> 
<div class="section"> 
 <h3 id="writeAvroToByteArray">writeAvroToByteArray</h3> 
</div> 
<p>The <tt>writeAvroToByteArray</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-avro/src/main/java/com/cloudera/cdk/morphline/avro/WriteAvroToByteArrayBuilder.java">source code</a>) serializes the Avro records contained in the _attachment_body field into a byte array and replaces the _attachment_body field with that byte array. The records must share an identical Avro schema. Often, the records were originally generated by the <a href="#toAvro">toAvro</a> command.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> format </td> 
   <td> container </td> 
   <td> Indicates the type of Avro output format that shall be written. Must be one of <tt>container</tt> (serialize into a byte array that contains Apache Avro binary container file data) or <tt>containerlessBinary</tt> (serialize into a byte array that contains Apache Avro without an Avro container and hence without a built-in writer schema) or <tt>containerlessJSON</tt> (same as <tt>containerlessBinary</tt> except that Avro output is encoded as JSON). </td> 
  </tr> 
  <tr class="a"> 
   <td> codec </td> 
   <td> null </td> 
   <td> Optional parameter that specifies the compression algorithm to use. Must be one of <tt>null</tt> or <tt>snappy</tt> or <tt>deflate</tt> or <tt>bzip2</tt>. This parameter only applies if <tt>format = container</tt>. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>writeAvroToByteArray {
  format : container 
  codec : snappy
}
</pre> 
</div> 
<div class="section"> 
 <h2 id="cdk-morphlines-json">cdk-morphlines-json</h2> 
</div> 
<p>This maven module contains morphline commands for reading, extracting, and transforming JSON files and JSON objects.</p> 
<div class="section"> 
 <h3 id="readJson">readJson</h3> 
</div> 
<p>The <tt>readJson</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-json/src/main/java/com/cloudera/cdk/morphline/json/ReadJsonBuilder.java">source code</a>) parses an InputStream or byte array that contains JSON data, using the <a class="externalLink" href="https://github.com/FasterXML/jackson-databind">Jackson</a> library. For each top level JSON object, the command emits a morphline record containing the top level object as an attachment in the field _attachment_body.</p> 
<p>The input stream or byte array is read from the first attachment of the input record.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> outputClass </td> 
   <td> <a class="externalLink" href="http://wiki.fasterxml.com/JacksonTreeModel">com.fasterxml.jackson.databind.JsonNode</a> </td> 
   <td> The fully qualified name of a Java class that <a class="externalLink" href="https://github.com/FasterXML/jackson-databind">Jackson</a> shall convert to. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>readJson {}
</pre> 
</div> 
<p>Example usage with conversion from JSON to <tt>java.util.Map</tt> objects:</p> 
<div class="source"> 
 <pre>readJson {
  outputClass : java.util.Map
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="extractJsonPaths">extractJsonPaths</h3> 
</div> 
<p>The <tt>extractJsonPaths</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-json/src/main/java/com/cloudera/cdk/morphline/json/ExtractJsonPathsBuilder.java">source code</a>) extracts specific values from a JSON object, akin to a simple form of XPath. The command uses zero or more JSON path expressions to extract values from a <a class="externalLink" href="https://github.com/FasterXML/jackson-databind">Jackson</a> JSON object of outputClass <a class="externalLink" href="http://wiki.fasterxml.com/JacksonTreeModel">com.fasterxml.jackson.databind.JsonNode</a>.</p> 
<p>The JSON input object is expected to be contained in the field _attachment_body, and typically placed there by an upstream <a href="#readJson">readJson</a> command with <tt>outputClass : com.fasterxml.jackson.databind.JsonNode</tt>.</p> 
<p>Each path expression consists of a record output field name (on the left side of the colon ':') as well as zero or more path steps (on the right hand side), each path step separated by a '/' slash, akin to a simple form of XPath. JSON arrays are traversed with the '[]' notation.</p> 
<p>The result of a path expression is a list of objects, each of which is added to the given record output field.</p> 
<p>The path language supports all JSON concepts, including such concepts as nested objects, arrays, etc. The path language supports a flatten option that collects the primitives in a subtree into a flat output list.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> flatten </td> 
   <td> true </td> 
   <td> Whether to collect the primitives in a subtree into a flat output list. </td> 
  </tr> 
  <tr class="a"> 
   <td> paths </td> 
   <td> [] </td> 
   <td> Zero or more JSON path expressions. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>extractJsonPaths {
  flatten : true
  paths : {
    my_price : /price

    my_docId : /docId
    my_links : /links
    my_links_backward : &quot;/links/backward&quot;
    my_links_forward : &quot;/links/forward&quot;
    my_name_language_code : &quot;/name[]/language[]/code&quot;
    my_name_language_country : &quot;/name[]/language[]/country&quot;
    my_name : /name    
  }
}
</pre> 
</div> 
<div class="section"> 
 <h2 id="cdk-morphlines-hadoop-core">cdk-morphlines-hadoop-core</h2> 
</div> 
<div class="section"> 
 <h3 id="downloadHdfsFile">downloadHdfsFile</h3> 
</div> 
<p>The <tt>downloadHdfsFile</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-hadoop-core/src/main/java/com/cloudera/cdk/morphline/hadoop/core/DownloadHdfsFileBuilder.java">source code</a>) downloads, on startup, zero or more files or directory trees from HDFS to the local file system. These files are typically static configuration files that are required by downstream morphline commands, e.g. Avro schema files, XML join tables, grok dictionaries, etc. Storing such configuration files in HDFS can help with consistent centralized configuration management across a set of cluster nodes.</p> 
<p>The output directory on the local file system defaults to the current working directory of the current process. If the effective output file or directory already exists it will be deleted and overwritten.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> inputFiles </td> 
   <td> <a href=".html"></a> </td> 
   <td> The HDFS files or directories to download, in the form of a list of HDFS URIs. </td> 
  </tr> 
  <tr class="a"> 
   <td> outputDir </td> 
   <td> &quot;.&quot; </td> 
   <td> The relative or absolute path of the destination directory on the local file system. Parent directories of that directory will be created automatically. Defaults to the current working directory of the current process. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>downloadHdfsFile {
  inputFiles : [&quot;hdfs://c2202.mycompany.com/user/foo/configs/sample-schema.avsc&quot;]
  outputDir : &quot;myconfigs&quot;
}
</pre> 
</div> 
<div class="section"> 
 <h2 id="cdk-morphlines-hadoop-sequencefile">cdk-morphlines-hadoop-sequencefile</h2> 
</div> 
<div class="section"> 
 <h3 id="readSequenceFile">readSequenceFile</h3> 
</div> 
<p>The <tt>readSequenceFile</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-hadoop-sequencefile/src/main/java/com/cloudera/cdk/morphline/hadoop/sequencefile/ReadSequenceFileBuilder.java">source code</a>) parses an Apache Hadoop <a class="externalLink" href="http://archive.cloudera.com/cdh4/cdh/4/hadoop/api/org/apache/hadoop/io/SequenceFile.html">SequenceFile</a> and emits a morphline record for each contained key-value pair. The sequence file is read from the input stream of the first attachment of the record.</p> 
<p>The command automatically handles Record-Compressed and Block-Compressed SequenceFiles.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> keyField </td> 
   <td> _attachment_name </td> 
   <td> The name of the output field to store the SequenceFile Record key. </td> 
  </tr> 
  <tr class="a"> 
   <td> valueField </td> 
   <td> _attachment_body </td> 
   <td> The name of the output field to store the SequenceFile Record value. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>readSequenceFile {
  keyField : &quot;key&quot;
  valueField : &quot;value&quot;
}
</pre> 
</div> 
<div class="section"> 
 <h2 id="cdk-morphlines-hadoop-rcfile">cdk-morphlines-hadoop-rcfile</h2> 
</div> 
<div class="section"> 
 <h3 id="readRCFile">readRCFile</h3> 
</div> 
<p>The <tt>readRCFile</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-hadoop-rcfile/src/main/java/com/cloudera/cdk/morphline/hadoop/rcfile/ReadRCFileBuilder.java">source code</a>) parses an Apache Hadoop <a class="externalLink" href="http://archive.cloudera.com/cdh4/cdh/4/hive/api/org/apache/hadoop/hive/ql/io/RCFile.html">RCFile</a>. An RCFile can be read Row-wise or Column-wise, as follows:</p> 
<ul> 
 <li>Row-wise: One morphline record is emitted for each row in the RCFile. Each record will contain fields for all the columns configured in the <tt>columns</tt> parameter. For example, with an RCFile with 10 rows and 5 columns, Row-wise mode would emit 10 morphline records.</li> 
 <li>Column-wise: For each column specified in the <tt>columns</tt> parameter, one morphline record per column cell value is emitted. A single RCFile column is read completely from top to bottom before moving to the next column. The order of columns is as specified in the <tt>columns</tt> parameter. For example, with an RCFile with 10 rows and 5 columns, Column-wise mode would emit 50 morphline records.</li> 
</ul> 
<p>The InputStream of the RCFile is read from the _attachment_body field of the input record. Optionally, the name of the RCFile is read from the _attachment_name field of the input record. Providing a name for the InputStream will, in case of errors, result in error messages containing said name for better debugging and diagnostics.</p> 
<p>The command automatically handles compressed RCFiles.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> readMode </td> 
   <td> row </td> 
   <td> Valid values: <tt>row</tt> or <tt>column</tt>. Defines the reading strategy. Affects the structure and number of output records that will be emitted, as discussed above. </td> 
  </tr> 
  <tr class="a"> 
   <td> includeMetaData </td> 
   <td> false </td> 
   <td> Whether or not the RCFile metadata shall be included in the output record. </td> 
  </tr> 
  <tr class="b"> 
   <td> columns </td> 
   <td> n/a </td> 
   <td> A list of column configurations. Since an RCFile does not store meta information about the columns itself, this configuration is necessary to read the RCFile. </td> 
  </tr> 
 </tbody> 
</table> 
<p>The columns configuration has the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> inputField </td> 
   <td> n/a </td> 
   <td> Non-negative integer index of the RCFile column to read. </td> 
  </tr> 
  <tr class="a"> 
   <td> outputField </td> 
   <td> n/a </td> 
   <td> The name of the field to add output values to. The output record will have the value of the column added to this field. </td> 
  </tr> 
  <tr class="b"> 
   <td> writableClass </td> 
   <td> n/a </td> 
   <td> Fully Qualified Class Name of a sub-class of <tt>org.apache.hadoop.io.Writable</tt>. Instances of this class are used to read the value of the column bytes, and said instances are added to the <tt>outputField</tt>. For example <tt>org.apache.hadoop.io.Text</tt> or <tt>org.apache.hadoop.io.LongWritable</tt> or <tt>org.apache.hadoop.hive.serde2.columnar.BytesRefWritable</tt> </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>readRCFile {
  readMode: row
  includeMetaData: false
  columns: [
    {
      inputField: 0
      outputField: name
      writableClass: &quot;org.apache.hadoop.io.Text&quot;
    }
    {
      inputField: 3
      outputField: age
      writableClass: &quot;org.apache.hadoop.io.LongWritable&quot;
    }
    {
      inputField: 1000
      outputField: photo
      writableClass: &quot;org.apache.hadoop.hive.serde2.columnar.BytesRefWritable&quot;
    }
  ]
}
</pre> 
</div> 
<div class="section"> 
 <h2 id="cdk-morphlines-maxmind">cdk-morphlines-maxmind</h2> 
</div> 
<div class="section"> 
 <h3 id="geoIP">geoIP</h3> 
</div> 
<p><b>Status: EXPERIMENTAL</b></p> 
<p>The <tt>geoIP</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-maxmind/src/main/java/com/cloudera/cdk/morphline/maxmind/GeoIPBuilder.java">source code</a>) returns Geolocation information for a given IP address, using an efficient in-memory Maxmind database lookup. The command stores a corresponding Jackson JsonNode Java object into the _attachment_body record field. The most recent version of the Maxmind GeoLite2 database can be downloaded as a flat data file from <a class="externalLink" href="http://dev.maxmind.com/geoip/geoip2/geolite2">Maxmind</a>.</p> 
<p>Often, the <tt>geoIP</tt> command is combined with commands such as <a href="#extractJsonPaths">extractJsonPaths</a>.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> inputField </td> 
   <td> n/a </td> 
   <td> The name of the input field that contains zero or more IP addresses. </td> 
  </tr> 
  <tr class="a"> 
   <td> database </td> 
   <td> GeoLite2-City.mmdb </td> 
   <td> The relative or absolute path of a Maxmind database file on the local file system. Example: /path/to/GeoLite2-City.mmdb </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre># extract geolocation info into a Jackson JsonNode Java object 
# and store it into the _attachment_body field:
geoIP {
  inputField : ip
  database : &quot;target/test-classes/GeoLite2-City.mmdb&quot;
}

# extract parts of the geolocation info from the Jackson JsonNode Java 
# object contained in the _attachment_body field and store the parts in
# the given record output fields:      
extractJsonPaths {
  flatten : false
  paths : { 
    /country/iso_code : /country/iso_code
    /country/names/en : /country/names/en
    /country/names/zh-CN : /country/names/zh-CN       
    &quot;/subdivisions[]/names/en&quot; : &quot;/subdivisions[]/names/en&quot;     
    &quot;/subdivisions[]/iso_code&quot; : &quot;/subdivisions[]/iso_code&quot;     
    /city/names/en : /city/names/en
    /postal/code : /postal/code
    /location/latitude : /location/latitude
    /location/longitude : /location/longitude
    /location/latitude_longitude : /location/latitude_longitude
    /location/longitude_latitude : /location/longitude_latitude
  } 
}
</pre> 
</div> 
<div class="section"> 
 <h4 id="Example_geoIP_JSON_output_with_extractJsonPaths">Example geoIP JSON output with extractJsonPaths</h4> 
</div> 
<p>Input: <tt>ip: 128.101.101.101</tt></p> 
<p>Expected output:</p> 
<div class="source"> 
 <pre>ip: 128.101.101.101
/country/iso_code: US
/country/names/en: United States
/country/names/zh-CN: 美国
/subdivisions[]/names/en: Minnesota
/subdivisions[]/iso_code: MN
/city/names/en: Minneapolis
/postal/code: 55455
/location/latitude: 44.9733
/location/longitude: -93.2323
/location/latitude_longitude: 44.9733,-93.2323
/location/longitude_latitude: -93.2323,44.9733
</pre> 
</div> 
<div class="section"> 
 <h4 id="Example_geoIP_JSON_output">Example geoIP JSON output</h4> 
</div> 
<p>Input: <tt>ip: 128.101.101.101</tt></p> 
<p>Expected output:</p> 
<div class="source"> 
 <pre>{
   &quot;city&quot;:{
      &quot;geoname_id&quot;:5037649,
      &quot;names&quot;:{
         &quot;de&quot;:&quot;Minneapolis&quot;,
         &quot;en&quot;:&quot;Minneapolis&quot;,
         &quot;es&quot;:&quot;Mine&aacute;polis&quot;,
         &quot;fr&quot;:&quot;Minneapolis&quot;,
         &quot;ja&quot;:&quot;ミネアポリス&quot;,
         &quot;pt-BR&quot;:&quot;Minneapolis&quot;,
         &quot;ru&quot;:&quot;Миннеаполис&quot;,
         &quot;zh-CN&quot;:&quot;明尼阿波利斯&quot;
      }
   },
   &quot;continent&quot;:{
      &quot;code&quot;:&quot;NA&quot;,
      &quot;geoname_id&quot;:6255149,
      &quot;names&quot;:{
         &quot;de&quot;:&quot;Nordamerika&quot;,
         &quot;en&quot;:&quot;North America&quot;,
         &quot;es&quot;:&quot;Norteam&eacute;rica&quot;,
         &quot;fr&quot;:&quot;Am&eacute;rique du Nord&quot;,
         &quot;ja&quot;:&quot;北アメリカ&quot;,
         &quot;pt-BR&quot;:&quot;Am&eacute;rica do Norte&quot;,
         &quot;ru&quot;:&quot;Северная Америка&quot;,
         &quot;zh-CN&quot;:&quot;北美洲&quot;
      }
   },
   &quot;country&quot;:{
      &quot;geoname_id&quot;:6252001,
      &quot;iso_code&quot;:&quot;US&quot;,
      &quot;names&quot;:{
         &quot;de&quot;:&quot;USA&quot;,
         &quot;en&quot;:&quot;United States&quot;,
         &quot;es&quot;:&quot;Estados Unidos&quot;,
         &quot;fr&quot;:&quot;&Eacute;tats-Unis&quot;,
         &quot;ja&quot;:&quot;アメリカ合衆国&quot;,
         &quot;pt-BR&quot;:&quot;Estados Unidos&quot;,
         &quot;ru&quot;:&quot;США&quot;,
         &quot;zh-CN&quot;:&quot;美国&quot;
      }
   },
   &quot;location&quot;:{
      &quot;latitude&quot;:44.9733,
      &quot;longitude&quot;:-93.2323,
      &quot;metro_code&quot;:&quot;613&quot;,
      &quot;time_zone&quot;:&quot;America/Chicago&quot;
      &quot;latitude_longitude&quot;:&quot;44.9733,-93.2323&quot;
      &quot;longitude_latitude&quot;:&quot;-93.2323,44.9733&quot;
   },
   &quot;postal&quot;:{
      &quot;code&quot;:&quot;55455&quot;
   },
   &quot;registered_country&quot;:{
      &quot;geoname_id&quot;:6252001,
      &quot;iso_code&quot;:&quot;US&quot;,
      &quot;names&quot;:{
         &quot;de&quot;:&quot;USA&quot;,
         &quot;en&quot;:&quot;United States&quot;,
         &quot;es&quot;:&quot;Estados Unidos&quot;,
         &quot;fr&quot;:&quot;&Eacute;tats-Unis&quot;,
         &quot;ja&quot;:&quot;アメリカ合衆国&quot;,
         &quot;pt-BR&quot;:&quot;Estados Unidos&quot;,
         &quot;ru&quot;:&quot;США&quot;,
         &quot;zh-CN&quot;:&quot;美国&quot;
      }
   },
   &quot;subdivisions&quot;:[
      {
         &quot;geoname_id&quot;:5037779,
         &quot;iso_code&quot;:&quot;MN&quot;,
         &quot;names&quot;:{
            &quot;en&quot;:&quot;Minnesota&quot;,
            &quot;es&quot;:&quot;Minnesota&quot;,
            &quot;ja&quot;:&quot;ミネソタ州&quot;,
            &quot;ru&quot;:&quot;Миннесота&quot;
         }
      }
   ]
}
</pre> 
</div> 
<div class="section"> 
 <h2 id="cdk-morphlines-metrics-servlets">cdk-morphlines-metrics-servlets</h2> 
</div> 
<div class="section"> 
 <h3 id="registerJVMMetrics">registerJVMMetrics</h3> 
</div> 
<p>The <tt>registerJVMMetrics</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-metrics-servlets/src/main/java/com/cloudera/cdk/morphline/metrics/servlets/RegisterJVMMetricsBuilder.java">source code</a>) registers metrics that are related to the Java Virtual Machine with the MorphlineContext of the morphline. For example, this includes metrics for garbage collection events, buffer pools, threads and thread deadlocks.</p> 
<p>Often, the <tt>registerJVMMetrics</tt> command is combined with commands such as <a href="#startReportingMetricsToHTTP">startReportingMetricsToHTTP</a> or <a href="#startReportingMetricsToJMX">startReportingMetricsToJMX</a> or <a href="#startReportingMetricsToSLF4J">startReportingMetricsToSLF4J</a> or <a href="#startReportingMetricsToCSV">startReportingMetricsToCSV</a>.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>registerJVMMetrics {}
</pre> 
</div> 
<div class="section"> 
 <h3 id="startReportingMetricsToHTTP">startReportingMetricsToHTTP</h3> 
</div> 
<p><b>Status: EXPERIMENTAL</b></p> 
<p>The <tt>startReportingMetricsToHTTP</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-metrics-servlets/src/main/java/com/cloudera/cdk/morphline/metrics/servlets/StartReportingMetricsToHTTPBuilder.java">source code</a>) exposes liveness status, health check status, metrics state and thread dumps via a set of HTTP URLs served by <a class="externalLink" href="http://en.wikipedia.org/wiki/Jetty_(web_server)">Jetty</a>, using the <a class="externalLink" href="http://metrics.codahale.com/manual/servlets/">AdminServlet</a>.</p> 
<p>On startup, a Jetty HTTP server is created that listens on a configurable port. If an HTTP server isn't required for your use case, and reporting metrics to JMX (or SLF4J or CSV) is sufficient, consider command such as <a href="#startReportingMetricsToJMX">startReportingMetricsToJMX</a> or <a href="#startReportingMetricsToSLF4J">startReportingMetricsToSLF4J</a> or <a href="#startReportingMetricsToCSV">startReportingMetricsToCSV</a>.</p> 
<p>Often, the <tt>startReportingMetricsToHTTP</tt> command is combined with the <a href="#registerJVMMetrics">registerJVMMetrics</a> command.</p> 
<p>The following HTTP URLs are provided:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> URL Path </b></th> 
   <th><b> Servlet </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> / </td> 
   <td> AdminServlet </td> 
   <td> an HTML admin menu, for example at <tt>http://foo.com:8080/</tt>, with links to the following servlets: </td> 
  </tr> 
  <tr class="a"> 
   <td> /ping </td> 
   <td> PingServlet </td> 
   <td> PingServlet responds to GET requests with a text/plain/200 OK response of <tt>pong</tt>. This is useful for determining liveness for load balancers, etc. </td> 
  </tr> 
  <tr class="b"> 
   <td> /healthcheck </td> 
   <td> HealthCheckServlet </td> 
   <td> HealthCheckServlet responds to GET requests by running all the health checks registered with the morphline context, and returning 501 Not Implemented if no health checks are registered, 200 OK if all pass, or 500 Internal Service Error if one or more fail. The results are returned as a human-readable text/plain JSON entity. </td> 
  </tr> 
  <tr class="a"> 
   <td> /metrics </td> 
   <td> MetricsServlet </td> 
   <td> MetricsServlet exposes the state of the metrics registered with the morphline context as a JSON object. </td> 
  </tr> 
  <tr class="b"> 
   <td> /threads </td> 
   <td> ThreadDumpServlet </td> 
   <td> ThreadDumpServlet responds to GET requests with a text/plain representation of all the live threads in the JVM, their states, their stack traces, and the state of any locks they may be waiting for. </td> 
  </tr> 
 </tbody> 
</table> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> port </td> 
   <td> 8080 </td> 
   <td> The port on which the HTTP server shall listen. </td> 
  </tr> 
  <tr class="a"> 
   <td> defaultDurationUnit </td> 
   <td> milliseconds </td> 
   <td> Report output durations in the given time unit. One of <tt>nanoseconds</tt>, <tt>microseconds</tt>, <tt>milliseconds</tt>, <tt>seconds</tt>, <tt>minutes</tt>, <tt>hours</tt>, <tt>days</tt>. </td> 
  </tr> 
  <tr class="b"> 
   <td> defaultRateUnit </td> 
   <td> seconds </td> 
   <td> Report output rates in the given time unit. One of <tt>nanoseconds</tt>, <tt>microseconds</tt>, <tt>milliseconds</tt>, <tt>seconds</tt>, <tt>minutes</tt>, <tt>hours</tt>, <tt>days</tt>. Example output: events/second </td> 
  </tr> 
 </tbody> 
</table> 
<div class="section"> 
 <h5 id="Example_startReportingMetricsToHTTP_Usage">Example startReportingMetricsToHTTP Usage</h5> 
</div> 
<div class="source"> 
 <pre>startReportingMetricsToHTTP {
  port : 8080
}
</pre> 
</div> 
<div class="section"> 
 <h5 id="Example_startReportingMetricsToHTTP_ping_output">Example startReportingMetricsToHTTP ping output</h5> 
</div> 
<p>Here is the response to an HTTP GET to http://localhost:8080/ping for liveness check:</p> 
<div class="source"> 
 <pre>pong
</pre> 
</div> 
<div class="section"> 
 <h5 id="Example_startReportingMetricsToHTTP_healthcheck_output">Example startReportingMetricsToHTTP healthcheck output</h5> 
</div> 
<p>Example output of running healthchecks via a HTTP GET to http://localhost:8080/healthcheck</p> 
<div class="source"> 
 <pre>{&quot;deadlocks&quot;:{&quot;healthy&quot;:true}}
</pre> 
</div> 
<div class="section"> 
 <h5 id="Example_startReportingMetricsToHTTP_metrics_output">Example startReportingMetricsToHTTP metrics output</h5> 
</div> 
<p>For an example on how to update user defined custom metrics such as counters, meters, timers and histograms, see the <a href="#java">java</a> command. Here is an example output of the JSON metrics reported by an HTTP GET to http://localhost:8080/metrics?pretty=true</p> 
<div class="source"> 
 <pre>{
 &quot;version&quot; : &quot;3.0.0&quot;,
 &quot;gauges&quot; : {
   &quot;jvm.gc.ConcurrentMarkSweep.count&quot; : {
     &quot;value&quot; : 0
   },
   &quot;jvm.gc.ConcurrentMarkSweep.time&quot; : {
     &quot;value&quot; : 0
   },
   &quot;jvm.gc.ParNew.count&quot; : {
     &quot;value&quot; : 4
   },
   &quot;jvm.gc.ParNew.time&quot; : {
     &quot;value&quot; : 29
   },
   &quot;jvm.memory.heap.committed&quot; : {
     &quot;value&quot; : 85000192
   },
   &quot;jvm.memory.heap.init&quot; : {
     &quot;value&quot; : 0
   },
   &quot;jvm.memory.heap.max&quot; : {
     &quot;value&quot; : 129957888
   },
   &quot;jvm.memory.heap.usage&quot; : {
     &quot;value&quot; : 0.1319703810514372
   },
   &quot;jvm.memory.heap.used&quot; : {
     &quot;value&quot; : 17150592
   },
   &quot;jvm.memory.non-heap.committed&quot; : {
     &quot;value&quot; : 24711168
   },
   &quot;jvm.memory.non-heap.init&quot; : {
     &quot;value&quot; : 24317952
   },
   &quot;jvm.memory.non-heap.max&quot; : {
     &quot;value&quot; : 136314880
   },
   &quot;jvm.memory.non-heap.usage&quot; : {
     &quot;value&quot; : 0.16856530996469352
   },
   &quot;jvm.memory.non-heap.used&quot; : {
     &quot;value&quot; : 22978104
   },
   &quot;jvm.memory.pools.CMS-Old-Gen.usage&quot; : {
     &quot;value&quot; : 0.05705025643464222
   },
   &quot;jvm.memory.pools.CMS-Perm-Gen.usage&quot; : {
     &quot;value&quot; : 0.25629341311571074
   },
   &quot;jvm.memory.pools.Code-Cache.usage&quot; : {
     &quot;value&quot; : 0.018703460693359375
   },
   &quot;jvm.memory.pools.Par-Eden-Space.usage&quot; : {
     &quot;value&quot; : 0.5095581972509399
   },
   &quot;jvm.memory.pools.Par-Survivor-Space.usage&quot; : {
     &quot;value&quot; : 0.9115804036458334
   },
   &quot;jvm.memory.total.committed&quot; : {
     &quot;value&quot; : 109711360
   },
   &quot;jvm.memory.total.init&quot; : {
     &quot;value&quot; : 24317952
   },
   &quot;jvm.memory.total.max&quot; : {
     &quot;value&quot; : 266272768
   },
   &quot;jvm.memory.total.used&quot; : {
     &quot;value&quot; : 40248344
   },
   &quot;jvm.threads.blocked.count&quot; : {
     &quot;value&quot; : 2
   },
   &quot;jvm.threads.count&quot; : {
     &quot;value&quot; : 22
   },
   &quot;jvm.threads.daemon.count&quot; : {
     &quot;value&quot; : 4
   },
   &quot;jvm.threads.deadlocks&quot; : {
     &quot;value&quot; : [ ]
   },
   &quot;jvm.threads.new.count&quot; : {
     &quot;value&quot; : 0
   },
   &quot;jvm.threads.runnable.count&quot; : {
     &quot;value&quot; : 10
   },
   &quot;jvm.threads.terminated.count&quot; : {
     &quot;value&quot; : 0
   },
   &quot;jvm.threads.timed_waiting.count&quot; : {
     &quot;value&quot; : 8
   },
   &quot;jvm.threads.waiting.count&quot; : {
     &quot;value&quot; : 2
   }
 },
 &quot;counters&quot; : {
   &quot;myMetrics.myCounter&quot; : {
     &quot;count&quot; : 1
   }
 },
 &quot;histograms&quot; : {
   &quot;myMetrics.myHistogram&quot; : {
     &quot;count&quot; : 1,
     &quot;max&quot; : 100,
     &quot;mean&quot; : 100.0,
     &quot;min&quot; : 100,
     &quot;p50&quot; : 100.0,
     &quot;p75&quot; : 100.0,
     &quot;p95&quot; : 100.0,
     &quot;p98&quot; : 100.0,
     &quot;p99&quot; : 100.0,
     &quot;p999&quot; : 100.0,
     &quot;stddev&quot; : 0.0
   }
 },
 &quot;meters&quot; : {
   &quot;morphline.java.numNotifyCalls&quot; : {
     &quot;count&quot; : 1,
     &quot;m15_rate&quot; : 0.16929634497812282,
     &quot;m1_rate&quot; : 0.19779007785878447,
     &quot;m5_rate&quot; : 0.1934432200964012,
     &quot;mean_rate&quot; : 0.06666243138019297,
     &quot;units&quot; : &quot;events/second&quot;
   },
   &quot;morphline.java.numProcessCalls&quot; : {
     &quot;count&quot; : 1,
     &quot;m15_rate&quot; : 0.16929634497812282,
     &quot;m1_rate&quot; : 0.19779007785878447,
     &quot;m5_rate&quot; : 0.1934432200964012,
     &quot;mean_rate&quot; : 0.06666191145031655,
     &quot;units&quot; : &quot;events/second&quot;
   },
   &quot;morphline.logDebug.numNotifyCalls&quot; : {
     &quot;count&quot; : 3,
     &quot;m15_rate&quot; : 0.5078890349343685,
     &quot;m1_rate&quot; : 0.5933702335763534,
     &quot;m5_rate&quot; : 0.5803296602892035,
     &quot;mean_rate&quot; : 0.1999690981087056,
     &quot;units&quot; : &quot;events/second&quot;
   },
   &quot;morphline.logDebug.numProcessCalls&quot; : {
     &quot;count&quot; : 3,
     &quot;m15_rate&quot; : 0.5078890349343685,
     &quot;m1_rate&quot; : 0.5933702335763534,
     &quot;m5_rate&quot; : 0.5803296602892035,
     &quot;mean_rate&quot; : 0.19996765856402157,
     &quot;units&quot; : &quot;events/second&quot;
   },
   &quot;morphline.logWarn.numNotifyCalls&quot; : {
     &quot;count&quot; : 2,
     &quot;m15_rate&quot; : 0.33859268995624564,
     &quot;m1_rate&quot; : 0.39558015571756894,
     &quot;m5_rate&quot; : 0.3868864401928024,
     &quot;mean_rate&quot; : 0.11979779569659962,
     &quot;units&quot; : &quot;events/second&quot;
   },
   &quot;morphline.logWarn.numProcessCalls&quot; : {
     &quot;count&quot; : 2,
     &quot;m15_rate&quot; : 0.33859268995624564,
     &quot;m1_rate&quot; : 0.39558015571756894,
     &quot;m5_rate&quot; : 0.3868864401928024,
     &quot;mean_rate&quot; : 0.11979702071997292,
     &quot;units&quot; : &quot;events/second&quot;
   },
   &quot;morphline.pipe.numNotifyCalls&quot; : {
     &quot;count&quot; : 1,
     &quot;m15_rate&quot; : 0.16929634497812282,
     &quot;m1_rate&quot; : 0.19779007785878447,
     &quot;m5_rate&quot; : 0.1934432200964012,
     &quot;mean_rate&quot; : 0.05774150456461029,
     &quot;units&quot; : &quot;events/second&quot;
   },
   &quot;morphline.pipe.numProcessCalls&quot; : {
     &quot;count&quot; : 1,
     &quot;m15_rate&quot; : 0.16929634497812282,
     &quot;m1_rate&quot; : 0.19779007785878447,
     &quot;m5_rate&quot; : 0.1934432200964012,
     &quot;mean_rate&quot; : 0.05766282424671017,
     &quot;units&quot; : &quot;events/second&quot;
   },
   &quot;morphline.registerJVMMetrics.numNotifyCalls&quot; : {
     &quot;count&quot; : 1,
     &quot;m15_rate&quot; : 0.16929634497812282,
     &quot;m1_rate&quot; : 0.19779007785878447,
     &quot;m5_rate&quot; : 0.1934432200964012,
     &quot;mean_rate&quot; : 0.059902898599428295,
     &quot;units&quot; : &quot;events/second&quot;
   },
   &quot;morphline.registerJVMMetrics.numProcessCalls&quot; : {
     &quot;count&quot; : 1,
     &quot;m15_rate&quot; : 0.16929634497812282,
     &quot;m1_rate&quot; : 0.19779007785878447,
     &quot;m5_rate&quot; : 0.1934432200964012,
     &quot;mean_rate&quot; : 0.059902518235973874,
     &quot;units&quot; : &quot;events/second&quot;
   },
   &quot;morphline.startReportingMetricsToHTTP.numNotifyCalls&quot; : {
     &quot;count&quot; : 3,
     &quot;m15_rate&quot; : 0.5078890349343685,
     &quot;m1_rate&quot; : 0.5933702335763534,
     &quot;m5_rate&quot; : 0.5803296602892035,
     &quot;mean_rate&quot; : 0.19066147711547488,
     &quot;units&quot; : &quot;events/second&quot;
   },
   &quot;morphline.startReportingMetricsToHTTP.numProcessCalls&quot; : {
     &quot;count&quot; : 3,
     &quot;m15_rate&quot; : 0.5078890349343685,
     &quot;m1_rate&quot; : 0.5933702335763534,
     &quot;m5_rate&quot; : 0.5803296602892035,
     &quot;mean_rate&quot; : 0.19066014422550162,
     &quot;units&quot; : &quot;events/second&quot;
   },
   &quot;myMetrics.myMeter&quot; : {
     &quot;count&quot; : 1,
     &quot;m15_rate&quot; : 0.18400888292586468,
     &quot;m1_rate&quot; : 0.19889196960097935,
     &quot;m5_rate&quot; : 0.1966942907643235,
     &quot;mean_rate&quot; : 0.0698670918312095,
     &quot;units&quot; : &quot;events/second&quot;
   }
 },
 &quot;timers&quot; : {
   &quot;myMetrics.myTimer&quot; : {
     &quot;count&quot; : 1,
     &quot;max&quot; : 1.4000000000000001E-5,
     &quot;mean&quot; : 1.4000000000000001E-5,
     &quot;min&quot; : 1.4000000000000001E-5,
     &quot;p50&quot; : 1.4000000000000001E-5,
     &quot;p75&quot; : 1.4000000000000001E-5,
     &quot;p95&quot; : 1.4000000000000001E-5,
     &quot;p98&quot; : 1.4000000000000001E-5,
     &quot;p99&quot; : 1.4000000000000001E-5,
     &quot;p999&quot; : 1.4000000000000001E-5,
     &quot;stddev&quot; : 0.0,
     &quot;m15_rate&quot; : 0.18400888292586468,
     &quot;m1_rate&quot; : 0.19889196960097935,
     &quot;m5_rate&quot; : 0.1966942907643235,
     &quot;mean_rate&quot; : 0.0698417274708746,
     &quot;duration_units&quot; : &quot;seconds&quot;,
     &quot;rate_units&quot; : &quot;calls/second&quot;
   },
   &quot;myMetrics.myTimer2&quot; : {
     &quot;count&quot; : 1,
     &quot;max&quot; : 0.0,
     &quot;mean&quot; : 0.0,
     &quot;min&quot; : 0.0,
     &quot;p50&quot; : 0.0,
     &quot;p75&quot; : 0.0,
     &quot;p95&quot; : 0.0,
     &quot;p98&quot; : 0.0,
     &quot;p99&quot; : 0.0,
     &quot;p999&quot; : 0.0,
     &quot;stddev&quot; : 0.0,
     &quot;m15_rate&quot; : 0.18400888292586468,
     &quot;m1_rate&quot; : 0.19889196960097935,
     &quot;m5_rate&quot; : 0.1966942907643235,
     &quot;mean_rate&quot; : 0.0698418152725891,
     &quot;duration_units&quot; : &quot;seconds&quot;,
     &quot;rate_units&quot; : &quot;calls/second&quot;
   }
 }
}
</pre> 
</div> 
<div class="section"> 
 <h4 id="Example_startReportingMetricsToHTTP_thread_dump_output">Example startReportingMetricsToHTTP thread dump output</h4> 
</div> 
<p>Here is the response to an HTTP GET to http://localhost:8080/threads for a thread dump:</p> 
<div class="source"> 
 <pre>main id=1 state=TIMED_WAITING
    at java.lang.Thread.sleep(Native Method)
    at com.cloudera.cdk.morphline.metrics.servlets.HttpMetricsMorphlineTest.testBasic(HttpMetricsMorphlineTest.java:51)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)

Reference Handler id=2 state=WAITING
    - waiting on &lt;0x7418e252&gt; (a java.lang.ref.Reference$Lock)
    - locked &lt;0x7418e252&gt; (a java.lang.ref.Reference$Lock)
    at java.lang.Object.wait(Native Method)
    at java.lang.Object.wait(Object.java:485)
    at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:116)

... and so on
</pre> 
</div> 
<div class="section"> 
 <h2 id="cdk-morphlines-tika-core">cdk-morphlines-tika-core</h2> 
</div> 
<p>This maven module contains morphline commands for autodetecting MIME types from binary data. Depends on tika-core.</p> 
<div class="section"> 
 <h3 id="detectMimeType">detectMimeType</h3> 
</div> 
<p>The <tt>detectMimeType</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-tika-core/src/main/java/com/cloudera/cdk/morphline/tika/DetectMimeTypeBuilder.java">source code</a>) uses Apache Tika to autodetect the <a class="externalLink" href="https://en.wikipedia.org/wiki/Internet_media_type">MIME type</a> of the first attachment from the binary data. The detected MIME type is assigned to the _attachment_mimetype field.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> includeDefaultMimeTypes </td> 
   <td> true </td> 
   <td> Whether to include the Tika default MIME types file that ships embedded in tika-core.jar (see <a class="externalLink" href="http://github.com/apache/tika/blob/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml">http://github.com/apache/tika/blob/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml</a>) </td> 
  </tr> 
  <tr class="a"> 
   <td> mimeTypesFiles </td> 
   <td> [] </td> 
   <td> The relative or absolute path of zero or more Tika custom-mimetypes.xml files to include. </td> 
  </tr> 
  <tr class="b"> 
   <td> mimeTypesString </td> 
   <td> null </td> 
   <td> The content of an optional custom-mimetypes.xml file embedded directly inside of this morphline configuration file. </td> 
  </tr> 
  <tr class="a"> 
   <td> preserveExisting </td> 
   <td> true </td> 
   <td> Whether to preserve the _attachment_mimetype field value if one is already present. </td> 
  </tr> 
  <tr class="b"> 
   <td> includeMetaData </td> 
   <td> false </td> 
   <td> Whether to pass the record fields to Tika to assist in MIME type detection. </td> 
  </tr> 
  <tr class="a"> 
   <td> excludeParameters </td> 
   <td> true </td> 
   <td> Whether to remove MIME parameters from output MIME type. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>detectMimeType {
  includeDefaultMimeTypes : false
  #mimeTypesFiles : [src/test/resources/custom-mimetypes.xml]
  mimeTypesString :
    &quot;&quot;&quot;
    &lt;mime-info&gt;
      &lt;mime-type type=&quot;text/space-separated-values&quot;&gt;
        &lt;glob pattern=&quot;*.ssv&quot;/&gt;
      &lt;/mime-type&gt;

      &lt;mime-type type=&quot;avro/binary&quot;&gt;
        &lt;magic priority=&quot;50&quot;&gt;
          &lt;match value=&quot;0x4f626a01&quot; type=&quot;string&quot; offset=&quot;0&quot;/&gt;
        &lt;/magic&gt;
        &lt;glob pattern=&quot;*.avro&quot;/&gt;
      &lt;/mime-type&gt;

      &lt;mime-type type=&quot;mytwittertest/json+delimited+length&quot;&gt;
        &lt;magic priority=&quot;50&quot;&gt;
          &lt;match value=&quot;[0-9]+(\r)?\n\\{&amp;quot;&quot; type=&quot;regex&quot; offset=&quot;0:16&quot;/&gt;
        &lt;/magic&gt;
      &lt;/mime-type&gt;
    &lt;/mime-info&gt;
    &quot;&quot;&quot;
}
</pre> 
</div> 
<div class="section"> 
 <h2 id="cdk-morphlines-tika-decompress">cdk-morphlines-tika-decompress</h2> 
</div> 
<p>This maven module contains morphline commands for decompressing and unpacking files. Depends on tika-core and commons-compress.</p> 
<div class="section"> 
 <h3 id="decompress">decompress</h3> 
</div> 
<p>The <tt>decompress</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-tika-decompress/src/main/java/com/cloudera/cdk/morphline/tika/decompress/DecompressBuilder.java">source code</a>) decompresses the first attachment, and supports gzip and bzip2 format.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>decompress {}
</pre> 
</div> 
<div class="section"> 
 <h3 id="unpack">unpack</h3> 
</div> 
<p>The <tt>unpack</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-tika-decompress/src/main/java/com/cloudera/cdk/morphline/tika/decompress/UnpackBuilder.java">source code</a>) unpacks the first attachment, and supports tar, zip, and jar format. The command emits one record per contained file.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>unpack {}
</pre> 
</div> 
<div class="section"> 
 <h2 id="cdk-morphlines-saxon">cdk-morphlines-saxon</h2> 
</div> 
<p>This maven module contains morphline commands for reading, extracting and transforming XML and HTML with XPath, XQuery and XSLT.</p> 
<div class="section"> 
 <h3 id="convertHTML">convertHTML</h3> 
</div> 
<p>The <tt>convertHTML</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-saxon/src/main/java/com/cloudera/cdk/morphline/saxon/ConvertHTMLBuilder.java">source code</a>) converts any HTML to XHTML, using the <a class="externalLink" href="http://ccil.org/~cowan/XML/tagsoup">TagSoup</a> Java library.</p> 
<p>Instead of parsing well-formed or valid XML, this command parses HTML as it is found in the wild: poor, nasty and brutish, though quite often far from short. TagSoup (and hence this command) is designed for people who have to process this stuff using some semblance of a rational application design. By providing this converter, it allows standard XML tools to be applied to even the worst malformed HTML.</p> 
<p>The command reads an InputStream or byte array from the first attachment (field _attachment_body) of the input record, parses it as HTML and replaces the field with UTF-8 encoded XHTML.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> supportedMimeTypes </td> 
   <td> null </td> 
   <td> Optionally, require the input record to match one of the MIME types in this list. </td> 
  </tr> 
  <tr class="a"> 
   <td> charset </td> 
   <td> null </td> 
   <td> The character encoding to use for parsing input, for example, UTF-8. If none is specified the charset specified in the _attachment_charset input field is used instead. </td> 
  </tr> 
  <tr class="b"> 
   <td> noNamespaces </td> 
   <td> true </td> 
   <td> A value of <tt>false</tt> indicates namespace URIs and unprefixed local names for element and attribute names will be available. </td> 
  </tr> 
  <tr class="a"> 
   <td> noCDATA </td> 
   <td> false </td> 
   <td> A value of <tt>true</tt> indicates that the parser will treat CDATA elements specially. </td> 
  </tr> 
  <tr class="b"> 
   <td> noBogons </td> 
   <td> false </td> 
   <td> A value of <tt>true</tt> indicates that the parser will ignore unknown elements. </td> 
  </tr> 
  <tr class="a"> 
   <td> emptyBogons </td> 
   <td> false </td> 
   <td> A value of <tt>true</tt> indicates that the parser will give unknown elements a content model of EMPTY; a value of <tt>false</tt>, a content model of ANY. </td> 
  </tr> 
  <tr class="b"> 
   <td> noRootBogons </td> 
   <td> false </td> 
   <td> A value of <tt>true</tt> indicates that the parser will allow unknown elements to be the root element. </td> 
  </tr> 
  <tr class="a"> 
   <td> noDefaultAttributes </td> 
   <td> false </td> 
   <td> A value of <tt>true</tt> indicates that the parser will return default attribute values for missing attributes that have default values. </td> 
  </tr> 
  <tr class="b"> 
   <td> noColons </td> 
   <td> false </td> 
   <td> A value of <tt>true</tt> indicates that the parser will translate colons into underscores in names. </td> 
  </tr> 
  <tr class="a"> 
   <td> noRestart </td> 
   <td> false </td> 
   <td> A value of <tt>true</tt> indicates that the parser will attempt to restart the restartable elements. </td> 
  </tr> 
  <tr class="b"> 
   <td> suppressIgnorableWhitespace </td> 
   <td> true </td> 
   <td> A value of <tt>false</tt> indicates that the parser will transmit whitespace in element-only content via the SAX ignorableWhitespace callback. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>convertHTML {
  charset : UTF-8
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="xquery">xquery</h3> 
</div> 
<p>The <tt>xquery</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-saxon/src/main/java/com/cloudera/cdk/morphline/saxon/XQueryBuilder.java">source code</a>) parses an InputStream that contains an XML document and runs the given <a class="externalLink" href="http://www.w3.org/TR/xquery">W3C XQuery</a> over the XML document, using the <a class="externalLink" href="http://www.saxonica.com">Saxon</a> Java library. For each item in the query result sequence, the command emits a corresponding morphline record.</p> 
<p>The command reads an InputStream or byte array from the first attachment (field _attachment_body) of the input record.</p> 
<p>Per the W3C specs, every valid XPath (e.g. //tweets/tweet[@color='blue']) is also a valid XQuery. If you are comfortable with XPath you are already almost there.</p> 
<p>An XQuery result sequence contains zero or more items such as element nodes, attribute nodes, text nodes, atomic values, etc. For each item in the query result sequence, the morphline command converts the item to a record and pipes that record to the next morphline command. For an attribute node the attribute's <a class="externalLink" href="http://www.w3.org/TR/xquery-operators/#func-string">XPath string value</a> is filled into the record field named after the attribute name. For an element node the attributes and children of the element are treated as follows: The XPath string value of the attribute or child is filled into the record field named after the child's name.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> supportedMimeTypes </td> 
   <td> null </td> 
   <td> Optionally, require the input record to match one of the MIME types in this list. </td> 
  </tr> 
  <tr class="a"> 
   <td> languageVersion </td> 
   <td> &quot;1.0&quot; </td> 
   <td> Must be <tt>&quot;1.0&quot;</tt> for XQuery 1.0 or <tt>&quot;3.0&quot;</tt> for XQuery 3.0. </td> 
  </tr> 
  <tr class="b"> 
   <td> features </td> 
   <td> null </td> 
   <td> An optional JSON object containing zero or more name-value pairs that represent configuration properties for <a class="externalLink" href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/lib/FeatureKeys.html">Saxon features</a>. </td> 
  </tr> 
  <tr class="a"> 
   <td> fragments </td> 
   <td> n/a </td> 
   <td> An array containing exactly one <i>fragment</i> JSON object, as described below. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Each fragment provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> fragmentPath </td> 
   <td> n/a </td> 
   <td> Currently must be <tt>&quot;/&quot;</tt> </td> 
  </tr> 
  <tr class="b"> 
   <td> externalVariables </td> 
   <td> null </td> 
   <td> An optional JSON object containing zero or more name-value pairs that are bound and passed in as <a class="externalLink" href="http://bit.ly/13Q82Ro">external variables</a> to the query. Example: <tt>myVar : &quot;hello world&quot;</tt> </td> 
  </tr> 
  <tr class="a"> 
   <td> externalFileVariables </td> 
   <td> null </td> 
   <td> An optional JSON object containing zero or more name-path pairs that refer to XML files on the local file system, and are bound and passed in as <a class="externalLink" href="http://bit.ly/13Q82Ro">external variables</a> to the query. These files are loaded once on program startup and subsequently remain memory resident across queries. This can be used for efficient joins where the join table is static and fits into main memory. Example: <tt>myDoc : src/test/resources/testdocuments/helloworld.xml</tt> </td> 
  </tr> 
  <tr class="b"> 
   <td> queryFile </td> 
   <td> null </td> 
   <td> A relative or absolute path of a local file from which to load the query. </td> 
  </tr> 
  <tr class="a"> 
   <td> queryString </td> 
   <td> null </td> 
   <td> An inline string from which to load the query. One of <tt>queryFile</tt> or <tt>queryString</tt> must be present, but not both. Example: <tt>&quot;&quot;&quot;/tweets/tweet&quot;&quot;&quot;</tt> </td> 
  </tr> 
 </tbody> 
</table> 
<dl> 
 <dd>
   Note: The morphline configuration file is implemented using the HOCON format (Human Optimized Config Object Notation). HOCON is basically JSON slightly adjusted for the configuration file use case. HOCON syntax is defined at 
  <a class="externalLink" href="http://github.com/typesafehub/config/blob/master/HOCON.md">HOCON github page</a> and as such, multi-line strings are similar to Python or Scala, using triple quotes. If the three-character sequence 
  <tt>&quot;&quot;&quot;</tt> appears, then all Unicode characters until a closing 
  <tt>&quot;&quot;&quot;</tt> sequence are used unmodified to create a string value. 
 </dd> 
</dl> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>xquery {
  fragments : [
    {
      fragmentPath : &quot;/&quot;
      externalVariables : {
        myVariable : &quot;hello world&quot;
      }            
      queryString : &quot;&quot;&quot;
        (: Example test xquery :)        
        
        declare variable $myVariable as xs:string external;
        
        for $tweet in /tweets/tweet
        return 
        &lt;user&gt;
          {$tweet/@id} 
          {$tweet/user/@screen_name} 
          &lt;myStatusCounts&gt;{string($tweet/user/@statuses_count)}&lt;/myStatusCounts&gt;
          &lt;text&gt;{$tweet/text}&lt;/text&gt;
          &lt;greeting&gt;{$myVariable}&lt;/greeting&gt;
        &lt;/user&gt;
      &quot;&quot;&quot;
    }
  ]
}
</pre> 
</div> 
<p>Here is an example output record for the query above:</p> 
<div class="source"> 
 <pre>id:11111112
screen_name:fake_user1
myStatusCounts:11111
text:Come, see new hot tub under Redwood Tree!
greeting:hello world
</pre> 
</div> 
<p>More examples can be found in the <a class="externalLink" href="https://github.com/cloudera/cdk/tree/master/cdk-morphlines/cdk-morphlines-saxon/src/test/resources/test-morphlines">unit tests</a>.</p> 
<p>For more background, see resources such as the <a class="externalLink" href="http://www.stylusstudio.com/xquery_primer_new.html">XQuery Primer</a> and <a class="externalLink" href="http://www.stylusstudio.com/xquery_flwor.html">XQuery FLOWR Tutorial</a> and <a class="externalLink" href="http://www.datadirect.com/resources/dis/xquery-guided-tour/index.html">XQuery: A Guided Tour</a> and <a class="externalLink" href="http://en.wikipedia.org/wiki/XQuery">Wikipedia</a>.</p> 
<div class="section"> 
 <h3 id="xslt">xslt</h3> 
</div> 
<p>The <tt>xslt</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-saxon/src/main/java/com/cloudera/cdk/morphline/saxon/XSLTBuilder.java">source code</a>) parses an InputStream that contains an XML document and runs the given <a class="externalLink" href="http://www.w3.org/TR/xslt20">W3C XSL Transform</a> over the XML document, using the <a class="externalLink" href="http://www.saxonica.com">Saxon</a> Java library. For each item in the query result sequence, the command emits a corresponding morphline record.</p> 
<p>The command reads an InputStream or byte array from the first attachment (field _attachment_body) of the input record.</p> 
<p>An XSLT result sequence contains zero or more items such as element nodes, attribute nodes, text nodes, atomic values, etc. For each item in the query result sequence, the morphline command converts the item to a record and pipes that record to the next morphline command. For an attribute node the attribute's <a class="externalLink" href="http://www.w3.org/TR/xquery-operators/#func-string">XPath string value</a> is filled into the record field named after the attribute name. For an element node the attributes and children of the element are treated as follows: The XPath string value of the attribute or child is filled into the record field named after the child's name.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> supportedMimeTypes </td> 
   <td> null </td> 
   <td> Optionally, require the input record to match one of the MIME types in this list. </td> 
  </tr> 
  <tr class="a"> 
   <td> features </td> 
   <td> null </td> 
   <td> An optional JSON object containing zero or more name-value pairs that represent configuration properties for <a class="externalLink" href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/lib/FeatureKeys.html">Saxon features</a>. </td> 
  </tr> 
  <tr class="b"> 
   <td> fragments </td> 
   <td> n/a </td> 
   <td> An array containing exactly one <i>fragment</i> JSON object, as described below. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Each fragment provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <tbody> 
  <tr class="a"> 
   <td> fragmentPath </td> 
   <td> n/a </td> 
   <td> Currently must be <tt>&quot;/&quot;</tt> </td> 
  </tr> 
  <tr class="b"> 
   <td> parameters </td> 
   <td> null </td> 
   <td> An optional JSON object containing zero or more name-value pairs that are bound and passed in as <a class="externalLink" href="http://www.w3schools.com/xsl/el_param.asp">XSLT parameters</a> to the query. Example: <tt>myVar : &quot;hello world&quot;</tt> </td> 
  </tr> 
  <tr class="a"> 
   <td> fileParameters </td> 
   <td> null </td> 
   <td> An optional JSON object containing zero or more name-path pairs that refer to XML files on the local file system, and are bound and passed in as <a class="externalLink" href="http://bit.ly/13Q82Ro">external variables</a> to the query. These files are loaded once on program startup and subsequently remain memory resident across queries. This can be used for efficient joins where the join table is static and fits into main memory. Example: <tt>myDoc : src/test/resources/testdocuments/helloworld.xml</tt> </td> 
  </tr> 
  <tr class="b"> 
   <td> queryFile </td> 
   <td> null </td> 
   <td> A relative or absolute path of a local file from which to load the query. </td> 
  </tr> 
  <tr class="a"> 
   <td> queryString </td> 
   <td> null </td> 
   <td> An inline string from which to load the query. One of <tt>queryFile</tt> or <tt>queryString</tt> must be present, but not both. </td> 
  </tr> 
 </tbody> 
</table> 
<dl> 
 <dd>
   Note: The morphline configuration file is implemented using the HOCON format (Human Optimized Config Object Notation). HOCON is basically JSON slightly adjusted for the configuration file use case. HOCON syntax is defined at 
  <a class="externalLink" href="http://github.com/typesafehub/config/blob/master/HOCON.md">HOCON github page</a> and as such, multi-line strings are similar to Python or Scala, using triple quotes. If the three-character sequence 
  <tt>&quot;&quot;&quot;</tt> appears, then all Unicode characters until a closing 
  <tt>&quot;&quot;&quot;</tt> sequence are used unmodified to create a string value. 
 </dd> 
</dl> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>xslt {
  fragments : [
    {
      fragmentPath : &quot;/&quot;
      parameters : {
        myVariable : &quot;hello world&quot;
      }            
      queryString : &quot;&quot;&quot;
        &lt;!-- Example XSLT identity transformation --&gt;
        &lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;1.0&quot;&gt;
        
        &lt;xsl:template match=&quot;@*|node()&quot;&gt;
          &lt;xsl:copy&gt;
            &lt;xsl:apply-templates select=&quot;@*|node()&quot;/&gt;
          &lt;/xsl:copy&gt;
        &lt;/xsl:template&gt;
        
        &lt;/xsl:stylesheet&gt;
      &quot;&quot;&quot;
    }
  ]
}
</pre> 
</div> 
<p>More examples can be found in the <a class="externalLink" href="https://github.com/cloudera/cdk/tree/master/cdk-morphlines/cdk-morphlines-saxon/src/test/resources/test-morphlines">unit tests</a>.</p> 
<p>For more background, see resources such as the <a class="externalLink" href="http://www.w3schools.com/xsl/">XSLT Tutorial</a> and <a class="externalLink" href="http://en.wikipedia.org/wiki/XSLT">Wikipedia</a>.</p> 
<div class="section"> 
 <h2 id="cdk-morphlines-solr-core">cdk-morphlines-solr-core</h2> 
</div> 
<p>This maven module contains morphline commands for Solr that higher level modules such as cdk-morphlines-solr-cell, search-mr, and search-flume depend on for indexing.</p> 
<div class="section"> 
 <h3 id="solrLocator">solrLocator</h3> 
</div> 
<p>A <tt>solrLocator</tt> is a set of configuration parameters that identify the location and schema of a Solr server or SolrCloud. Based on this information a morphline Solr command can fetch the Solr index schema and send data to Solr. A <tt>solrLocator</tt> is not actually a command but rather a common parameter of many morphline Solr commands, and thus described separately here.</p> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>solrLocator : {
  # Name of solr collection
  collection : collection1

  # ZooKeeper ensemble
  zkHost : &quot;127.0.0.1:2181/solr&quot;

  # Max number of documents to pass per RPC from morphline to Solr Server
  # batchSize : 1000
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="loadSolr">loadSolr</h3> 
</div> 
<p>The <tt>loadSolr</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-core/src/main/java/com/cloudera/cdk/morphline/solr/LoadSolrBuilder.java">source code</a>) loads a record into a Solr server or MapReduce Reducer.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> solrLocator </td> 
   <td> n/a </td> 
   <td> Solr location parameters as described separately above. </td> 
  </tr> 
  <tr class="a"> 
   <td> boosts </td> 
   <td> [] </td> 
   <td> An optional JSON object containing zero or more fieldName-boostValue mappings where the fieldName is a String and the boostValue is a float. The default boost is <tt>1.0</tt>. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>loadSolr {
  solrLocator : {
    # Name of solr collection
    collection : collection1

    # ZooKeeper ensemble
    zkHost : &quot;127.0.0.1:2181/solr&quot;

    # Max number of docs to pass per RPC from morphline to Solr Server
    # batchSize : 1000
  }
  boosts : {
    id : 2.0 # assign to the id field a boost value 2.0
  }
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="generateSolrSequenceKey">generateSolrSequenceKey</h3> 
</div> 
<p>The <tt>generateSolrSequenceKey</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-core/src/main/java/com/cloudera/cdk/morphline/solr/GenerateSolrSequenceKeyBuilder.java">source code</a>) assigns a record unique key that is the concatenation of the given <tt>baseIdField</tt> record field, followed by a running count of the record number within the current session. The count is reset to zero whenever a <tt>startSession</tt> notification is received.</p> 
<p>For example, assume a CSV file containing multiple records but no unique ids, and the base_id field is the filesystem path of the file. Now this command can be used to assign the following record values to Solr's unique key field: <tt>$path#0, $path#1, ... $path#N</tt>.</p> 
<p>The name of the unique key field is fetched from Solr's <tt>schema.xml</tt> file, as directed by the <tt>solrLocator</tt> configuration parameter.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> solrLocator </td> 
   <td> n/a </td> 
   <td> Solr location parameters as described separately above. </td> 
  </tr> 
  <tr class="a"> 
   <td> baseIdField </td> 
   <td> baseid </td> 
   <td> The name of the input field to use for prefixing keys. </td> 
  </tr> 
  <tr class="b"> 
   <td> preserveExisting </td> 
   <td> true </td> 
   <td> Whether to preserve the field value if one is already present. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>generateSolrSequenceKey {
  baseIdField: ignored_base_id
  solrLocator : ${SOLR_LOCATOR}
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="sanitizeUnknownSolrFields">sanitizeUnknownSolrFields</h3> 
</div> 
<p>The <tt>sanitizeUnknownSolrFields</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-core/src/main/java/com/cloudera/cdk/morphline/solr/SanitizeUnknownSolrFieldsBuilder.java">source code</a>) sanitizes record fields that are unknown to Solr <tt>schema.xml</tt> by either deleting them (<tt>renameToPrefix</tt> parameter is absent or a zero length string) or by moving them to a field prefixed with the given <tt>renameToPrefix</tt> (for example, to use typical dynamic Solr fields).</p> 
<p>Recall that Solr throws an exception on any attempt to load a document that contains a field that is not specified in <tt>schema.xml</tt>.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> solrLocator </td> 
   <td> n/a </td> 
   <td> Solr location parameters as described separately above. </td> 
  </tr> 
  <tr class="a"> 
   <td> renameToPrefix </td> 
   <td> &quot;&quot; </td> 
   <td> Output field prefix for unknown fields. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>sanitizeUnknownSolrFields {
  solrLocator : ${SOLR_LOCATOR}
}
</pre> 
</div> 
<div class="section"> 
 <h3 id="tokenizeText">tokenizeText</h3> 
</div> 
<p>The <tt>tokenizeText</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-core/src/main/java/com/cloudera/cdk/morphline/solr/TokenizeTextBuilder.java">source code</a>) uses the embedded <a class="externalLink" href="http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters">Solr/Lucene Analyzer library</a> to generate tokens from a text string, without sending data to a Solr server.</p> 
<p>This is useful for prototyping and debugging Solr applications. It is also useful for standalone usage outside of Solr, e.g. for extracting text features from documents for use with recommendation systems, clustering and classification applications.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> solrLocator </td> 
   <td> n/a </td> 
   <td> Solr location parameters as described separately above. </td> 
  </tr> 
  <tr class="a"> 
   <td> inputField </td> 
   <td> n/a </td> 
   <td> The name of the input field. </td> 
  </tr> 
  <tr class="b"> 
   <td> outputField </td> 
   <td> n/a </td> 
   <td> The name of the field to add output values to. </td> 
  </tr> 
  <tr class="a"> 
   <td> solrFieldType </td> 
   <td> n/a </td> 
   <td> The name of the Solr field type in <tt>schema.xml</tt> to use for text analysis and tokenization. This parameter specifies the algorithmic extraction rules. Example: &quot;text_en&quot; </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>tokenizeText {
  inputField : message
  outputField : tokens
  solrFieldType : text_en
  solrLocator : {
    # Name of solr collection
    collection : collection1

    # ZooKeeper ensemble
    zkHost : &quot;127.0.0.1:2181/solr&quot;
    
    # solrHomeDir : &quot;example/solr/collection1&quot;    
  }
}
</pre> 
</div> 
<p>For example, given the input field <tt>message</tt> with the value <tt>Hello World!\nFoo@Bar.com #%()123</tt> the expected output record is:</p> 
<div class="source"> 
 <pre>tokens:hello
tokens:world
tokens:foo
tokens:bar.com
tokens:123
</pre> 
</div> 
<p>This example assumes the Solr field type named &quot;text_en&quot; is defined in <tt>schema.xml</tt> as shown in the following snippet:</p> 
<div class="source"> 
 <pre>...
&lt;fieldType name=&quot;text_en&quot; class=&quot;solr.TextField&quot; positionIncrementGap=&quot;100&quot;&gt;
  &lt;analyzer type=&quot;index&quot;&gt;
    &lt;tokenizer class=&quot;solr.StandardTokenizerFactory&quot;/&gt;
    &lt;filter class=&quot;solr.StopFilterFactory&quot;
       ignoreCase=&quot;true&quot;
       words=&quot;lang/stopwords_en.txt&quot;
       enablePositionIncrements=&quot;true&quot;
    /&gt;
    &lt;filter class=&quot;solr.LowerCaseFilterFactory&quot;/&gt;
    &lt;filter class=&quot;solr.EnglishPossessiveFilterFactory&quot;/&gt;
    &lt;filter class=&quot;solr.KeywordMarkerFilterFactory&quot; protected=&quot;protwords.txt&quot;/&gt;
    &lt;filter class=&quot;solr.PorterStemFilterFactory&quot;/&gt;
  &lt;/analyzer&gt;
&lt;/fieldType&gt;
</pre> 
</div> 
<div class="section"> 
 <h2 id="cdk-morphlines-solr-cell">cdk-morphlines-solr-cell</h2> 
</div> 
<p>This maven module contains morphline commands for using SolrCell with Tika parsers. This includes support for types including HTML, XML, PDF, Word, Excel, Images, Audio, and Video.</p> 
<div class="section"> 
 <h3 id="solrCell">solrCell</h3> 
</div> 
<p>The <tt>solrCell</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-cell/src/main/java/com/cloudera/cdk/morphline/solrcell/SolrCellBuilder.java">source code</a>) pipes the first attachment of a record into one of the given Apache <a class="externalLink" href="http://tika.apache.org">Tika</a> parsers, then maps the Tika output back to a record using Apache SolrCell.</p> 
<p>The Tika parser is chosen from the configurable list of parsers, depending on the MIME type specified in the input record. Typically, this requires an upstream <tt>detectMimeType</tt> command.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> solrLocator </td> 
   <td> n/a </td> 
   <td> Solr location parameters as described separately above. </td> 
  </tr> 
  <tr class="a"> 
   <td> capture </td> 
   <td> [] </td> 
   <td> List of XHTML element names to extract from the Tika output. For instance, it could be used to grab paragraphs (&lt;p&gt;) and index them into a separate field. Note that content is also still captured into the overall &quot;content&quot; field. </td> 
  </tr> 
  <tr class="b"> 
   <td> fmaps </td> 
   <td> [] </td> 
   <td> Maps (moves) one field name to another. See the example below. </td> 
  </tr> 
  <tr class="a"> 
   <td> uprefix </td> 
   <td> null </td> 
   <td> The <tt>uprefix</tt> option indicates that the command shall prefix all fields that are not defined in the Solr <tt>schema.xml</tt> with the given prefix. Recall that Solr throws an exception on any attempt to load a document that contains a field that is not specified in <tt>schema.xml</tt>. The <tt>uprefix</tt> option is very useful when combined with dynamic field definitions. For example, <tt>uprefix : ignored</tt>_ would effectively ignore all unknown fields generated by Tika if the <tt>schema.xml</tt> contains the following dynamic field definition: <tt>dynamicField name=&quot;ignored</tt>_*&quot; <tt>type=&quot;ignored&quot;</tt> </td> 
  </tr> 
  <tr class="b"> 
   <td> captureAttr </td> 
   <td> false </td> 
   <td> Whether to index attributes of the Tika XHTML elements into separate fields, named after the element. For example, when extracting from HTML, Tika can return the href attributes in <tt>&lt;a&gt;</tt> tags as fields named &quot;a&quot;. </td> 
  </tr> 
  <tr class="a"> 
   <td> xpath </td> 
   <td> null </td> 
   <td> When extracting, only return Tika XHTML content that satisfies the XPath expression. See <a class="externalLink" href="http://tika.apache.org/1.4/parser.html">http://tika.apache.org/1.4/parser.html</a> for details on the format of Tika XHTML. See also <a class="externalLink" href="http://wiki.apache.org/solr/TikaExtractOnlyExampleOutput">http://wiki.apache.org/solr/TikaExtractOnlyExampleOutput</a>. </td> 
  </tr> 
  <tr class="b"> 
   <td> lowernames </td> 
   <td> false </td> 
   <td> Map all field names to lowercase with underscores. For example, ContentType would be mapped to contenttype. </td> 
  </tr> 
  <tr class="a"> 
   <td> solrContentHandlerFactory </td> 
   <td> com.cloudera.cdk.morphline. solrcell.TrimSolrContentHandlerFactory </td> 
   <td> A Java class to handle bridging from Tika to SolrCell. </td> 
  </tr> 
  <tr class="b"> 
   <td> parsers </td> 
   <td> [] </td> 
   <td> List of fully qualified Java class names of one or more Tika parsers. </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>solrCell {
  solrLocator : ${SOLR_LOCATOR}

  # extract some fields
  capture : [content, a, h1, h2]

  # rename exif_image_height field to text field
  # rename a field to anchor field
  # rename h1 field to heading1 field
  fmap : { exif_image_height : text, a : anchor, h1 : heading1 }

  # xpath : &quot;/xhtml:html/xhtml:body/xhtml:div/descendant:node()&quot;

  parsers : [ # one or more nested Tika parsers
    { parser : org.apache.tika.parser.jpeg.JpegParser }
  ]
}
</pre> 
</div> 
<p>Here is a complex morphline that demonstrates integrating multiple heterogenous input file formats via a <tt>tryRules</tt> command, including Avro and SolrCell, using auto detection of MIME types via <tt>detectMimeType</tt> command, recursion via the <tt>callParentPipe</tt> command for unwrapping container formats, and automatic UUID generation:</p> 
<div class="source"> 
 <pre>morphlines : [
  {
    id : morphline1
    importCommands : [&quot;com.cloudera.**&quot;, &quot;org.apache.solr.**&quot;]

    commands : [
      {
        # emit one output record for each attachment in the input
        # record's list of attachments. The result is a list of
        # records, each of which has at most one attachment.
        separateAttachments {}
      }

      {
        # used for auto-detection if MIME type isn't explicitly supplied
        detectMimeType {
          includeDefaultMimeTypes : true
          mimeTypesFiles : [target/test-classes/custom-mimetypes.xml]
        }
      }

      {
        tryRules {
          throwExceptionIfAllRulesFailed : true
          rules : [
            # next rule of tryRules cmd:
            {
              commands : [
                { logDebug { format : &quot;hello unpack&quot; } }
                { unpack {} }
                { generateUUID {} }
                { callParentPipe {} }
              ]
            }

            # next rule of tryRules cmd:
            {
              commands : [
                { logDebug { format : &quot;hello decompress&quot; } }
                { decompress {} }
                { callParentPipe {} }
              ]
            }

            # next rule of tryRules cmd:
            {
              commands : [
                {
                  readAvroContainer {
                    supportedMimeTypes : [avro/binary]
                    # optional, avro json schema blurb for getSchema()
                    # readerSchemaString : &quot;&lt;json can go here&gt;&quot;
                    # readerSchemaFile : /path/to/syslog.avsc
                  }
                }

                { extractAvroTree {} }

                {
                  setValues {
                    id : &quot;@{/id}&quot;
                    user_screen_name : &quot;@{/user_screen_name}&quot;
                    text : &quot;@{/text}&quot;
                  }
                }

                {
                  sanitizeUnknownSolrFields {
                    solrLocator : ${SOLR_LOCATOR}
                  }
                }
              ]
            }

            # next rule of tryRules cmd:
            {
              commands : [
                {
                  readJsonTestTweets {
                    supportedMimeTypes : [&quot;mytwittertest/json+delimited+length&quot;]
                  }
                }

                {
                  sanitizeUnknownSolrFields {
                    solrLocator : ${SOLR_LOCATOR}
                  }
                }
              ]
            }

            # next rule of tryRules cmd:
            {
              commands : [
                { logDebug { format : &quot;hello solrcell&quot; } }
                {
                  # wrap SolrCell around an Tika parsers
                  solrCell {
                    solrLocator : ${SOLR_LOCATOR}

                    capture : [
                      # twitter feed schema
                      user_friends_count
                      user_location
                      user_description
                      user_statuses_count
                      user_followers_count
                      user_name
                      user_screen_name
                      created_at
                      text
                      retweet_count
                      retweeted
                      in_reply_to_user_id
                      source
                      in_reply_to_status_id
                      media_url_https
                      expanded_url
                     ]

                    # rename &quot;content&quot; field to &quot;text&quot; fields
                    fmap : { content : text, content-type : content_type }

                    lowernames : true

                    # Tika parsers to be registered:
                    parsers : [
                      { parser : org.apache.tika.parser.asm.ClassParser }
                      { parser : org.gagravarr.tika.FlacParser }
                      { parser : org.apache.tika.parser.audio.AudioParser }
                      { parser : org.apache.tika.parser.audio.MidiParser }
                      { parser : org.apache.tika.parser.crypto.Pkcs7Parser }
                      { parser : org.apache.tika.parser.dwg.DWGParser }
                      { parser : org.apache.tika.parser.epub.EpubParser }
                      { parser : org.apache.tika.parser.executable.ExecutableParser }
                      { parser : org.apache.tika.parser.feed.FeedParser }
                      { parser : org.apache.tika.parser.font.AdobeFontMetricParser }
                      { parser : org.apache.tika.parser.font.TrueTypeParser }
                      { parser : org.apache.tika.parser.xml.XMLParser }
                      { parser : org.apache.tika.parser.html.HtmlParser }
                      { parser : org.apache.tika.parser.image.ImageParser }
                      { parser : org.apache.tika.parser.image.PSDParser }
                      { parser : org.apache.tika.parser.image.TiffParser }
                      { parser : org.apache.tika.parser.iptc.IptcAnpaParser }
                      { parser : org.apache.tika.parser.iwork.IWorkPackageParser }
                      { parser : org.apache.tika.parser.jpeg.JpegParser }
                      { parser : org.apache.tika.parser.mail.RFC822Parser }
                      { parser : org.apache.tika.parser.mbox.MboxParser,
                          additionalSupportedMimeTypes : [message/x-emlx] }
                      { parser : org.apache.tika.parser.microsoft.OfficeParser }
                      { parser : org.apache.tika.parser.microsoft.TNEFParser }
                      { parser : org.apache.tika.parser.microsoft.ooxml.OOXMLParser }
                      { parser : org.apache.tika.parser.mp3.Mp3Parser }
                      { parser : org.apache.tika.parser.mp4.MP4Parser }
                      { parser : org.apache.tika.parser.hdf.HDFParser }
                      { parser : org.apache.tika.parser.netcdf.NetCDFParser }
                      { parser : org.apache.tika.parser.odf.OpenDocumentParser }
                      { parser : org.apache.tika.parser.pdf.PDFParser }
                      { parser : org.apache.tika.parser.pkg.CompressorParser }
                      { parser : org.apache.tika.parser.pkg.PackageParser }
                      { parser : org.apache.tika.parser.rtf.RTFParser }
                      { parser : org.apache.tika.parser.txt.TXTParser }
                      { parser : org.apache.tika.parser.video.FLVParser }
                      { parser : org.apache.tika.parser.xml.DcXMLParser }
                      { parser : org.apache.tika.parser.xml.FictionBookParser }
                      { parser : org.apache.tika.parser.chm.ChmParser }
                    ]
                  }
                }

                { generateUUID { field : ignored_base_id } }

                {
                  generateSolrSequenceKey {
                    baseIdField: ignored_base_id
                    solrLocator : ${SOLR_LOCATOR}
                  }
                }

              ]
            }
          ]
        }
      }

      {
        loadSolr {
          solrLocator : ${SOLR_LOCATOR}
        }
      }

      {
        logDebug {
          format : &quot;My output record: {}&quot;
          args : [&quot;@{}&quot;]
        }
      }

    ]
  }
]
</pre> 
</div> 
<dl> 
 <dd>
   Note: More information on SolrCell can be found here: 
  <a class="externalLink" href="http://wiki.apache.org/solr/ExtractingRequestHandler">http://wiki.apache.org/solr/ExtractingRequestHandler</a> 
 </dd> 
</dl> 
<div class="section"> 
 <h2 id="cdk-morphlines-useragent">cdk-morphlines-useragent</h2> 
</div> 
<div class="section"> 
 <h3 id="userAgent">userAgent</h3> 
</div> 
<p>The <tt>userAgent</tt> command (<a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-useragent/src/main/java/com/cloudera/cdk/morphline/useragent/UserAgentBuilder.java">source code</a>) parses a user agent string and returns structured higher level data like user agent family, operating system, version, and device type, using the underlying API and regexes.yaml BrowserScope database from <a class="externalLink" href="https://github.com/tobie/ua-parser">ua-parser</a>.</p> 
<p>The command provides the following configuration options:</p> 
<table border="0" class="bodyTable table table-striped table-hover"> 
 <thead> 
  <tr class="a"> 
   <th><b> Property Name </b></th> 
   <th><b> Default </b></th> 
   <th><b> Description </b></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr class="b"> 
   <td> inputField </td> 
   <td> n/a </td> 
   <td> The name of the input field that contains zero or more user agent strings. </td> 
  </tr> 
  <tr class="a"> 
   <td> outputFields </td> 
   <td> [] </td> 
   <td> A JSON object containing zero or more user agent mappings. Each mapping consists of a record output field name (on the left side of the colon ':') as well as an expression (on the right hand side). An expression consists of a concatenation of zero or more literal strings or <i>components</i> of the form @{componentName}. Example mapping: myOutputField : &quot;@{ua_family}/@{ua_major}.@{ua_minor}.@{ua_patch}&quot;. The following components are available: ua_family, ua_major, ua_minor, ua_patch, os_family, os_major, os_minor, os_patch, os_patch_minor, device_family. If a component resolves to null or the empty string the preceding string separator, if any, is suppressed. </td> 
  </tr> 
  <tr class="b"> 
   <td> database </td> 
   <td> null </td> 
   <td> The (optional) relative or absolute path of a regexes.yaml database file on the local file system. The default is to use the standard regexes.yaml database file that ships embedded inside of the ua-parser-*.jar. Example: /path/to/regexes.yaml </td> 
  </tr> 
 </tbody> 
</table> 
<p>Example usage:</p> 
<div class="source"> 
 <pre>userAgent {
  inputField : user_agents
  outputFields : {
    ua_family : &quot;@{ua_family}&quot;
    device_family : &quot;@{device_family}&quot;
    ua_family_and_version : &quot;@{ua_family}/@{ua_major}.@{ua_minor}.@{ua_patch}&quot;
    os_family_and_version : &quot;@{os_family} @{os_major}.@{os_minor}.@{os_patch}&quot;
  }          
}
</pre> 
</div> 
<p>Example input:</p> 
<div class="source"> 
 <pre>user_agents : Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9B206 Safari/7534.48.3
</pre> 
</div> 
<p>Expected output:</p> 
<div class="source"> 
 <pre>ua_family : Mobile Safari
device_family : iPhone
ua_family_and_version : Mobile Safari/5.1
os_family_and_version : iOS 5.1.1
</pre> 
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li>
							<a href="../index.html" title="Home">Home </a>
						</li>
						<li>
							<a href="../release_notes.html" title="Release Notes">Release Notes </a>
						</li>
						<li>
							<a href="../apidocs/index.html" title="Javadoc">Javadoc </a>
						</li>
						<li>
							<a href="../jdiff/changes.html" title="API Diffs">API Diffs </a>
						</li>
						<li>
							<a href="../dependencies.html" title="Dependency Information">Dependency Information </a>
						</li>
						<li>
							<a href="http://github.com/cloudera/cdk-examples" title="Examples" class="externalLink">Examples </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Modules</li>
						<li>
							<a href="../cdk-data/index.html" title="CDK Data">CDK Data </a>
						</li>
						<li>
							<a href="../cdk-maven-plugin/index.html" title="CDK Maven Plugin">CDK Maven Plugin </a>
						</li>
						<li>
							<a href="index.html" title="CDK Morphlines">CDK Morphlines </a>
						</li>
						<li>
							<a href="../cdk-tools/index.html" title="CDK Tools">CDK Tools </a>
						</li>
						<li class="nav-header">CDK Morphlines</li>
						<li>
							<a href="index.html" title="Home">Home </a>
						</li>
						<li class="active">
							<a href="#" title="Morphlines Reference Guide">Morphlines Reference Guide </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Contribute</li>
						<li>
							<a href="http://github.com/cloudera/cdk" title="Source Repository" class="externalLink">Source Repository </a>
						</li>
						<li>
							<a href="https://issues.cloudera.org/browse/CDK" title="JIRA" class="externalLink">JIRA </a>
						</li>
						<li>
							<a href="https://groups.google.com/a/cloudera.org/forum/#!forum/cdk-dev" title="Mailing List" class="externalLink">Mailing List </a>
						</li>
						<li>
							<a href="../how_to_contribute.html" title="How To Contribute">How To Contribute </a>
						</li>
						<li>
							<a href="../adding_a_module.html" title="Adding a Module">Adding a Module </a>
						</li>
						<li>
							<a href="../project-info.html" title="Project Information">Project Information </a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2013-2014 <a href="http://www.cloudera.com">Cloudera</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 0.9.2. </span><span class="publishDate">Last Published: 2014-05-06. </span></p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->

	<!-- Fallback jQuery loading from Google CDN:
	     http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go -->
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script type="text/javascript">
		if (typeof jQuery == 'undefined')
		{
			document.write(unescape("%3Cscript src='./js/jquery-1.8.3.min.js' type='text/javascript'%3E%3C/script%3E"));
		}
	</script>
	
	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.js"></script>
	<script src="./js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="./js/jquery.ba-bbq.min.js"></script>
	<script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>
	
	</body>
</html>
